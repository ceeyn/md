# 用于生成具有群体代表性的结构脑网络的距离相关共识阈值



大规模的结构脑网络编码了分布在不同脑区的脑白质连接模式。这些连接模式被认为支持认知过程，当受到损害时，可能会导致神经认知缺陷和适应不良行为。研究大脑网络组织原理的一个有效方法是**从多个受试者队列中构建具有群体代表性的网络**。**这样做放大了信号与噪声的比率，并提供了更清晰的大脑网络组织图。**在这里，我们表明，**现有的生成稀疏组代表网络的方法高估了网络中存在的短程连接的比例，因此无法沿着广泛的网络统计信息匹配主体级别的网络。我们提出了一种替代方法，该方法保持了单个主题的连接长度分布。**我们在以前的论文中使用了这种方法来生成群代表网络，尽管到目前为止，它的性能还没有得到适当的基准测试，并与其他方法进行了比较。由于这一简单的修改，使用这种方法生成的网络成功地概括了主题水平的属性，通过更好地保留促进大脑综合功能而不是分离的特征，表现优于类似方法。本文提出的方法为未来研究大规模结构脑网络的基本组织原理和特征提供了希望



使用适当的平均过程可以简洁地表示来自**许多对象的稀疏结构连通性数据**。
然而，我们表明，几个流行的这样做的过程产生组平均网络，其统计数据与它们打算表示的对象级网络不同。
我们认为，这些不同之处在于，**在群体平均矩阵中，短程和长途连接的表达分别过高和过低。**
我们提出了一种**与距离相关的阈值过程，它保留了连接长度分布，从而更好地匹配了主题级网络及其统计数据**。
这些发现为数据驱动的连接点分析提供了信息。



尽管已经花费了相当大的努力来更好地理解脑网络结构的不同方面在个体之间是如何变化的(Yeh等人，2016年)，并与行为和临床特征一起变化(Gollo等人，2018年；MišÍc&Sporns，2016)，但研究具有群体代表性的脑网络也被证明有助于理解典型或普通大脑的网络组织和属性(Hagmann等人，2008年；van den Heuvel&Sporns，2011年)。
通常的情况是，群体代表网络是通过聚合来自许多受试者的网络数据，同时保留那些在受试者层面上一致表现的属性来生成的(De Reus&van den Heuvel，2013；Roberts，Perry，Roberts，Mitchell&BreakSpear，2017；Zalesky等人，2016)。
这种方法，如果仔细执行，可以在理论上增强信号，同时抑制噪声和伪影，从而提供对大脑网络组织的更清晰的看法

## 介绍

人脑是一个由神经元、种群和区域组成的网络，它们通过突触、轴突投射和有髓纤维束相互连接，这取决于所考虑的规模(Sporns，Tononi，&Kötter，2005)。
这些联系塑造了神经元素的输入和输出模式，并在决定任何给定元素的功能属性方面发挥着重要作用(Passingham，Stephan，&Köter，2002)。
通过将神经元件及其连接建模为图的节点和边，我们可以用汇总统计来量化大脑的网络组织，并阐明它们在健康、疾病和发育中的功能(Sporns，Tononi，&Edelman，2000)。



尽管已经花费了相当大的努力来更好地理解脑网络结构的不同方面在个体之间是如何变化的(Yeh等人，2016年)，并与行为和临床特征一起变化(Gollo等人，2018年；MišÍc&Sporns，2016)，但研究具有群体代表性的脑网络也被证明有助于理解典型或普通大脑的网络组织和属性(Hagmann等人，2008年；van den Heuvel&Sporns，2011年)。
通常的情况是，**群体代表网络是通过聚合来自许多受试者的网络数据，同时保留那些在受试者层面上一致表现的属性来生成的**(De Reus&van den Heuvel，2013；Roberts，Perry，Roberts，Mitchell&BreakSpear，2017；Zalesky等人，2016)。
这种方法，如果仔细执行，可以在理论上增强信号，同时抑制噪声和伪影，从而提供对大脑网络组织的更清晰的看法



构建群体代表网络的大多数方法都是“共识-群体代表网络”的变体：一个单一的网络旨在代表许多受试者的连通性数据。也就是说，**稀疏组网络是通过指定其值范围在0到1之间的阈值并保持在至少一部分受试者τ中观察到的连接来生成的。保留的连接通常与权重相关联，而所有其他连接被设置为0**(Roberts等人，2017)(图1A、1B)。在几乎每个应用中，相同的共识阈值被统一应用于所有可能的连接。
这种所谓的**共识阈值**：**一种通过只保留在给定部分(阈值)的受试者中出现的连接来生成组代表网络的过程。称为基于一致共识的阈值是常见的**，使用这种方法生成的组代表网络经常出现在网络神经科学文献中。
然而，需要注意的是，**“正确的”阈值通常是未知的，通常是根据试探法来选择的。**
此外，阈值的行为本身可能会引入偏见，并影响对网络组织和统计的后续解释(加里森、谢诺斯特、芬恩、沈和康斯特布尔，2015)。



群体代表网络的目的是作为样本，保留在单个受试者一级一致表达的特征，同时减少噪音和不确定性水平。
主题水平结构脑网络最显著的特征之一是**其拓扑特征对其空间嵌入的依赖**(Stiso&Bassett，2018)。**两个大脑区域连接的概率和连接的权重(如果存在)都随着区域间的距离单调衰减。**
这种效应已经在利用脑束成像算法从扩散磁共振成像重建的人类结构网络(Betzel&Bassett，2018；Roberts等人，2016；Samu，Seth，和Nowotny，2014)以及**使用侵入性方法重建的网络中得到报道**(Ercsey-Ravasz等人，2013；Horvát等人，2016)，这表明这些依赖**不是任何特定网络构建方法的简单人工制品，而是大规模脑网络的进化保守特征**(van den Heuvel，Bullmore，&Sporns，2016)



对强大的短距离连接的偏好可以用成本降低机制来解释(Bullmore&Sporns，2012；Vértes等人，2012)。
直觉上来说，更长与短距离连接相比，连接成本更高；它们需要额外的材料来形成，并需要额外的能量才能持续使用。
因此，神经系统进化成了更短、更低成本的连接。尽管如此，大脑网络仍然显示出一些远程连接(Betzel，Medaglia和Bassett，2018)。
人们普遍理解，较长的连接线扮演着关键的功能角色，以抵消它们的成本，尽管它们的确切功能仍未被完全理解。



![截屏2022-10-31 14.50.33](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 14.50.33.png)

**图1.群代表矩阵的构造和表面比较。**
组代表连通性矩阵通过保留在**受试者中一致表达的特征**来概括对象级网络数据(A)。在大多数应用中，感兴趣的特征是大脑区域之间的边缘及其权重。产生群代表矩阵的最直接的方法是首先构造一个感觉矩阵(B)，它的元素表示表达边的所有对象的分数。
通过保留至少在τ受试者中表达的所有连接并用权重填充这些连接，可以估计组代表性矩阵。
虽然这种方法很常见，但它也有一些缺点。
一般来说，因为观察到任何给定的短距离连接的概率大于观察到长距离连接的概率，所以短距离连接在不同受试者中的表现也更一致。
因此，在共识矩阵的所有要素上设定统一的基于共识的阈值将导致一个群体代表矩阵，在该矩阵中，短程连接的表达频率比任何单一受试者(C)都高得多。
为了绕过这个问题，我们提供了一种简单的替代方法。
简而言之，这包括在每个库中根据它们的长度将所有连接划分到库中，保留最频繁表达的连接。
这种依赖于距离的基于共识的阈值方法导致网络的边长分布几乎与典型受试者相同。
我们**还显示了使用距离相关阈值和统一共识阈值生成的组代表矩阵的差异**(在这里，我们选择τ作为统一方法，这样结果矩阵的连接数量与平均受试者的连接数量相等)。
(D)只存在于均匀方法中的连接以蓝色描述，而仅存在于距离依赖树枝方法中的那些连接以红色显示。
(E)我们在大脑上绘制这些相同方法特定的连接，并根据它们的长度(以毫米为单位)给它们上色。
(F)一般而言，统一方法所特有的连接是短距离连接(蓝色曲线)，而距离相关方法所特有的连接包括长距离连接。



无论它们的确切功能是什么，长途联系可以说是任何群体代表网络中需要保留的最重要的主题级特征之一。它们在提高最短路径效率(Kaiser&Hilgetag，2006)以及不同性别的多样化网络动态和信息处理(Betzel&Bassett，2018)方面发挥着重要作用。然而，统一的基于共识的阈值可能会产生大大低估了观察到的长途连接数量的网络。之所以出现这种偏见，是因为受试者之间的连接意识本身是依赖于距离的，短距离连接似乎比长距离连接更一致。因此，对于给定的连续门限，门限以上连接的分布总是偏向于短距离连接，而不是长距离连接。也就是说，与典型的受试者相比，使用统一的基于共识的阈值程序产生的具有群体代表性的网络作品将显示更多的短距离连接和更少的长距离连接(图1C-F)。由于远距离连接负责推动某些网络统计数据，这些具有群体代表性的网络也将无法与这些指标的主题级别网络匹配。



在这里，我们提出了一种构建群体代表网络的替代方法。我们的方法建立在基于共识的阈值框架之上，但从未适当地进行基准测试。我们在以前的论文中使用过(Betzel&Bassett，2018；Betzel，Gu，Medaglia，Pasqualetti和Bassett，2016；Betzel等人，2017；MišÍCtal，2015)；
与在所有连接上统一设置阈值不同，**我们允许阈值随距离的变化而变化，保留最一致的连接，条件是它们的长度。与现有方法不同，我们非参数地推导出与距离相关的阈值，以便与主题级别数据的集合边缘长度分布相匹配。**
我们比较了使用这种距离相关阈值方法生成的网络和使用更传统方法生成的网络，结果表明，在广泛的网络统计和比较度量中，使用距离相关方法生成的网络性能优于其他方法。
这种与距离相关的过程成功地概括了主题水平网络的许多重要组织特征，并展示了未来对结构脑网络的探索性研究的前景。



## 结果

**距离依赖共识阈值：与共识阈值相同，但连接保持阈值随距离而变化。**

在这一部分中，我们将比较四种不同的方法来生成具有群体代表性的结构连通性网络。

1.如果连接出现在至少一个主题中，则保留这些连接。我们把这种方法称为“简单”方法。

2.如果关系出现在至少50%的受试者中，就会被保留。我们将其称为“τ=0.5”方法

3.如果连接至少出现在τ平均主题中，则保持连接，其中τ平均主题是导致二进制密度等于典型主题的连续阈值。这里指的是“τ=Avg”方法。
注意：对于半球间/半球内连接，我们分别计算此阈值

**4.使用依赖于距离的共识阈值来保持连接。网络保留了典型受试者的大致边缘长度分布。将其称为“Dist”方法。与“τ=Avg”方法一样，对于半球间/半球内的连接，分别引入了依赖于距离的阈值。**



本节又分为四个小节。在前两个小节中，**我们比较了群体代表网络的统计数据和个体主题的统计数据。在下一节中，我们将描述与认知系统相关的组代表矩阵的连通性模式，并讨论对我们理解大脑功能的启示。**在最后的小节中，我们描述了中枢是如何重新分布的，这取决于用于生成具有群体代表性的大脑网络的方法。在这一小节中，我们报告了使用洛桑数据集(N=1,000个节点)的高分辨率部分的分析结果，其中白质纤维束是使用确定性流线束成像技术从扩散光谱成像数据中重建的(有关处理细节，请参阅材料和方法部分)。这些结果代表了我们使用更粗略的分析得出的结果。这些额外的结果包括在支持信息中，图S1和图S2(Betzel，Griffa，Hagmann，&MišÍc，2019年)。
最后，我们还**比较了基于距离的一致性方法和基于权重的阈值方法的结果。在该方法中，我们通过在“简单”的群体代表网络上施加一个权重阈值来生成一个新的群体代表网络。**这些分析结果载于附录中。



### 基于一致和距离的一致性阈值生成系统差异网络

结构连通性：神经元素之间的物理连接的地图(例如，神经元/群体之间的轴突投射，脑区/神经节之间的白质纤维路径)。

结构连通性网络中边的存在和权重表现出空间依赖，由于成本降低原则和重建伪像，使得短程连接在不同对象之间得到更一致的表达。
因此，生成使用统一共识阈值保持连接的组代表网络的程序必然会高估网络中的短程连接数量。在接下来的小节中，我们更详细地探索这些偏差的含义。在这里，我们简单地展示了统一共识阈值生成具有不同空间统计的组代表网络，其中边缘保持的阈值作为欧几里得距离的函数而变化。在图1D中，我们展示了包含存在于均匀或距离相关的组代表矩阵中的连接的邻接矩阵，但不是两者都存在。
在这个面板和图1E中，我们根据它们的长度在解剖空间和颜色连接中绘制这些相同的连接，长/短连接显示为亮红色/深蓝色。在左右子面板中，我们显示了以距离相关的方法存在的连接，而不是统一的方法，反之亦然。请注意，左子面板中显示的连接往往较长(红色)，这表明距离相关方法保留了统一方法中未保留的长距离连接。相反，右子面板中的连接倾向于短(蓝色)，这表明均匀方法具有距离相关方法所没有的短距离连接。可以通过检查一种方法而不是另一种方法中存在的连接的分布来总结这些趋势。在图1F4中，我们表明，正如预期的那样，由均匀方法保留的连接在25 mm附近急剧达到峰值，而由距离相关方法保留的连接分布更广，并包括许多远距离连接。我们注意到，τ=0.5和距离相关方法具有相同的二进制密度，使得直接比较这些矩阵是合适的



这些关于具有群体代表性的大脑网络连接长度分布差异的观察，尽管表面上是表面的，但对这些网络的结构特性具有重要的实际意义。
短距离连接的过度表达可能导致过度凝聚的脑网络模块(Roberts等人，2016；Samu等人，2014)，错过了潜在的丰富的模块间连接模式(Betzel，Medaglia等人，2018年)。相反，过度表达远距离连接的组代表网络可能缺乏分离的网络属性，如本地集群(Sporns&Zwi，2004)。这些观察结果与这样一个事实是一致的，即一般来说，网络属性不是彼此独立的，一个属性的变化会影响其他属性(Rubinov，2016)。在这里，也在整篇文章中，我们认为边长分布的错误刻画对群代表网络所展示的网络属性的谱以及这些属性是否与个体主体的网络的谱具有深远的影响。



**基于一致性的阈值处理不保留主题级别的网络统计信息**

有许多标准可以用来评估和判断具有群代表的连通性矩阵。可以说，其中最重要的是它们恢复和概括它们理应代表的主题级数据的拓扑属性的能力。在这一节中，我们比较了四种生成群体代表网络的方法，根据每种方法在网络统计集合方面与单个主题的匹配程度。重点关注局部统计量，如度、强度、聚类系数、中心度和边长分布，以及全局统计量，如二元连接数、总权重、平均聚类、拓扑效率、平均路径长度、调制度、直径和度分类。

我们根据**网络测量是局部定义还是全局定义**，将其分为两类。我们使用Kolmogorov-Smirnov(KS)检验，**比较了主体水平和群体代表性的局部测量**，即在单个节点水平上定义的局部测量。**KS检验统计量衡量两个累积分布之间的最大距离，较小的值表示更接近的对应。**在图2A-E中，我们覆盖了度、强度、聚类系数、中间度中心度和边长的累积分布

![截屏2022-10-31 15.15.44](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 15.15.44.png)

**比较不同方法的分布。**
我们给出了(A)度、(B)强度、(C)聚类系数、(D)居中中心度和(E)连接长度的累积分布。
叠加在这些分布上的是与我们测试的四种方法(彩色)相关联的曲线。
在面板(F)-(J)中，我们展示了每个网络测量的Kolmogorov-Smirnov(KS)统计量，该统计量将方法的累积分布曲线与单个受试者进行比较。



对于所有五种测量，我们发现基于距离的共识阈值方法优于其他三种方法，即较小的KS统计量(p<0.05；Bonfer-Roni校正)。这些结果表明，**距离相关方法比其他方法更好地保存了多个结点和边水平的测量**，这表明在其他组代表网络上计算的网络统计量可能具有误导性，因为它们不一定代表典型的对象。

我们对全球网络指标进行了类似的比较。在这里，我们没有使用KS检验来比较分布，而是对在组代表网络上计算的度量与相应的主题级别分布进行了z评分。**Z分数接近0意味着群体代表网络接近给定网络测量的平均受试者水平值。**在图3A-H中，我们显示了网络中的连接总数、平均聚类、效率和模块化的二进制和加权模拟。在比较网络直径、匹配度和平均路径长度时，发现了类似的结果，与本地网络测量一样，这些发现表明，关于如何生成群代表连通性矩阵的决定对其拓扑组织有影响。重要的是，最流行的方法-基于统一共识的阈值-与典型对象相比保留了更多的短程连接，因此表现出与该对象所表现出的不一致的拓扑属性

![截屏2022-10-31 15.29.32](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 15.29.32.png)

**比较标量网络统计信息。**在这里，我们比较了四种不同的群组代表脑网络方法的性能与单个受试者的性能。
(A)每一条代表单个受试者的二元连接的总数(灰色)，具有与平均受试者大致相同的连接数的统一方法(亮红色)，具有共识阈值τ=0.5的统一方法(深红色)，如果在甚至一个受试者中观察到连接，则保持连接的“简单”方法(蓝色)，以及与距离相关的方法(黑色)。
面板(B)-(D)显示了类似的曲线图，但在平均聚类性、效率和模块化方面。
面板(E)-(H)描述了这些相同的度量，但计算超过了二元网络的加权模拟。
(I)对于每一次测量(以及其他几次)，我们确定了最接近所有受试者平均水平的方法。
总体而言，我们发现与其他测试方法相比，距离相关方法的性能一直更好，在所有指标上都达到了排名1或2的水平。







在上一节中，我们比较了组代表网络在概括主题级别网络的拓扑性质方面的表现。另一个可以比较群体代表网络的重要维度是它们的**结构连接如何映射到大脑的功能和认知系统**。**在这里，我们通过平均先前描述的认知系统-休息-状态网络(RSNs；Schaefer等人，2017)之间的结构连通性权重来探索这种结构-功能关系**。休息状态网络由具有相似功能的连接轮廓的大脑区域组成，并重新定位在认知要求高的任务中共同激活的大脑区域的集合。**我们计算了四种组代表性方法中每一种方法的RSN间和RSN内的连接密度，在每种情况下都生成了一个逐个系统的连接密度矩阵(图4B)。我们也对单个主题进行了同样的操作，对这些主题级别矩阵进行平均，以获得其元素表示所有主题的平均系统间连接密度的单个矩阵(图4A)。为了比较组矩阵和主题矩阵，我们计算它们的上三角+对角线元素的皮尔逊相关性。**



总体而言，我们发现**每个组代表矩阵与主题级别矩阵正相关**，这表明，总体上，**所有方法都在组级别保持了主题级别的系统到系统的连通性。**尽管如此，不同群体代表性方法在相关性大小和与同一线的偏差方面仍有相当大的差异(图4C)。例如，“SIMPLE”方法显示r≈为0.92，但大大高估了连接密度的幅度。同样，阈值为τ=0.5的均匀方法的相关性要弱得多，r=0.85。另一方面，其余两种方法的相关性要强得多，其震级超过r≈0.93，数据点在等值线附近的分布大致相同。

两种表现最好的方法是统一方法和距离相关方法，我们选择了一个阈值，导致与平均对象相同的密度。我们更详细地比较了这两种方法，以更好地理解使用一种方法与另一种方法的含义。
首先，我们计算了RSN间连接密度的差异(图4D)。
我们发现，两者之间存在着微妙但系统性的差异。
特别是，我们发现与均匀方法相比，**距离相关方法的RSN内密度要弱得多，而RSN间连接密度也更强**(p<0.05，排列检验；图4E，4F)。

这些发现对脑网络数据的分析和解释具有重要的意义。
对于旨在将结构和功能大脑网络的特征相互联系的研究来说，这一点尤其正确。
过去使用统一共识阈值构建的具有群体代表性的数据进行的研究可能无法匹配受试者水平网络的特异性

![截屏2022-10-31 15.53.35](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 15.53.35.png)



**图4.比较RSN内部/之间的连接模式。**
我们比较了不同群体代表网络在规范脑系统内部和之间的连接密度，这些连接密度取自Schaefer等人(2017)。
(A)典型受试者的RSN间连接密度。(B)四种不同群体代表网络的RSN间连接密度：(左至右)与受试者密度相同的一致一致方法、阈值设置为τ=0.5时的一致一致方法、“简单”方法和距离相关方法。(C)我们如何显示每种方法(y轴)的RSN间密度与对象平均值(x轴)的相关模式。在这些方法中，与典型受试者密度相同的距离依赖方法和均匀方法效果最好。我们对这些方法进行比较，以便更好地了解它们的差异。(D)距离相关方法和τ=0.5阈值方法在RSN间连接密度上的差异。蓝色表示均匀法连接密度较大，红色密度表示距离相关法连接密度较大。(E)我们发现，平均而言，均匀方法产生的RSN内密度弱于距离相关方法，而距离相关方法具有较大的RSN间密度。(F)我们展示了观察到的RSN内部和之间的密度差异，并将其与零方法进行了比较。这里，我们显示了零分布(蓝色)和观测值(红色)。零分布是通过独立和随机排列每个原始连通性矩阵的行/列，并根据RSN系统标签进行重新聚集来构造的。然后计算RSN内密度/RSN间密度的平均差

而简单的平均方法可能高估了短程连接的权重(van den Heuvel&Sporns，2013)。
这些缺陷原则上可能导致对结构-功能联系的错误描述。更重要的是，这些发现表明，群代表网络的构建方法的不同可能导致网络强调分**离特征--即由统一方法表示的更强的RSN内连接密度--或强调综合特征--即由距离相关方法表达的更强的RSN间连接密度。**
信息分离和整合之间的平衡被认为是形成大脑网络拓扑结构的重要组织原则(Cohen&D‘Esposito，2016；Deco，Tononi，Boly&Kringelbach，2015；Sporns，2013)。
我们的发现表明，不同的群体代表方法不同地强调了这些特征，这表明用户在方法上看似随意的选择可能会对网络上的测量产生影响



### 枢纽(再)配送

**比较群体代表网络的第三种方法是测量中枢区域的再分布，即评估由于选择一种群体方法而不是另一种群体方法而导致的“中央”脑区位置的变化。**在这里，我们比较了均匀方法和距离依赖方法下的中心度、结点度、聚类系数和参与系数的空间分布。为了确保比较区域尽可能公平，我们在比较之前对所有衡量标准进行了排名转换。



总体而言，我们发现了广泛的和半球对称的中心区域的再分布。在中间性中心性的情况下(图5A)，我们发现**在距离依赖的方法下，与认知控制相关的区域越来越集中，而躯体运动系统中的区域变得不那么中央**(p<0.05；通过将错误发现率控制在5%来纠正多重比较；图5e)。
就程度而言(图5B)，我们发现**控制和边缘系统建立了更多的联系，而背侧注意、突出/腹侧注意、躯体运动和视觉系统表现出较少的联系**(图5F)。对于聚集系数(图5C)，我们发现默认模式和电机系统的组件更聚集，而控制网络的多个组件聚集较少(图5G)。最后，在参与系数方面(图5D)，我们发现背部注意和视觉系统表现出更多的参与，而躯体运动和其他视觉系统表现出更少的参与(图5H)



![截屏2022-10-31 16.10.15](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 16.10.15.png)



图5.比较枢纽的空间分布。我们比较了四个衡量中心性的指标：(A)中心性、(B)度、(C)集群系数和(D)参与系数。我们不是比较由于连接总数或权重等全局网络属性的微小差异而可能波动的原始值，**而是比较每个度量的排名值**，并观察在距离相关或统一方法下节点的排名是更小还是更大。橙色节点表示距离相关方法下的节点值大于均匀方法下的值。蓝色的节点表示相反的情况。然后，**我们汇总了认知系统在排序度量中的节点级别差异，并将系统级别的平均值与零值法获得的值进行了比较**。在面板(E)-(H)中，我们展示了z评分的系统平均值。总体而言，z值越大，表明两种方法之间的系统级别差异越大。



这些发现对我们理解大脑功能具有重要意义。中枢和中央大脑区域被认为对控制区域间通信和调节大脑网络模块内部和之间的信息流非常重要。事实上，将一个地区指定为“枢纽”对于假说的产生很重要，在其他研究中也起到了重要的确证作用。我们的发现表明，这些定义至少在一定程度上取决于用于生成群体代表网络的方法。此外，方法之间的一些最显著的差异适用于特定的认知系统，这对我们如何解释与中枢和大脑功能相关的发现有额外的影响。



## 讨论

在本文中，我们充实了一种生成组代表性脑网络的新方法的细节，该方法在保留主题级别统计方面优于更传统的方法。
具体地说，我们表明，这种方法更好地保存了局部和全局网络统计数据，其结构-功能关系与个体受试者的结构-功能关系更一致，并且它对大脑中高度中央中枢区域的位置产生了不同的直觉



## 材料和方法

在这项研究中，我们比较了从结构连接性数据构建具有群体代表性的大脑网络的方法。我们使用扩散谱磁共振数据进行了这些比较，这些数据被分成三个不同组织规模的网络。在这里，我们将更详细地描述这些处理步骤。



### 磁共振成像采集

共70例健康受试者(年龄28.8±9.1岁，男性43例)在3T扫描仪上进行扫描，头线圈为32通道(Magnetom TrioTim，Magnetom Prisma，德国西门子医疗)。会议包括(A)磁化准备的快速采集梯度回波(MPRAGE)序列(分辨率1×1×1.2 mm，240×257×160个体素；tr=2,300ms，TE=2.98 ms，TI=900ms)；(B)扩散谱成像(DSI)序列(2.2×2.2×3 mm分辨率；96×96×34个体素；tr=6,100ms，TE=144ms；q45个采集，最大b值8000s/mm2，1b0体积)。知情书面同意符合机构指南，该议定书得到了瑞士洛桑大学生物和医学系临床研究伦理委员会的批准





### 核磁共振图像的预处理

使用**开放式聚合软件Connectome Mapper计算各个连接矩阵**，它使用序列中描述的参数在不同的处理步骤调用不同的工具

使用Freesurfer软件版本5.0.0(Dale，Fischl，&Sereno，1999)**将MPRAGE体积分割为白质、灰质和脑脊液**。皮质体积被划分为五个逐渐细化的小块，其中68个、114个、219个、448个和1,000个大小大致相同(Cammun等人，2012年)。这里，我们分析68个、219个和1,000个地块分区。按照Wedeen及其同事(V.J.Wedeen，Hagmann，Tseng，Reese，&Weisskoff，2005)描述的方法重建DSI数据，从而估计**每个体素中的取向分布函数(ODF)**。**在每个体素中识别最多三个主流线方向作为ODF(扩散工具包软件)的最大值**



在重建的DSI数据上使用**确定性流线束成像对个体参与者的结构连接性矩阵**进行估计，在每个白质体素的每个扩散方向发起32个流线建议(V.Wedeen等人，2008年)。使用基于丰富的成本函数(Freesurfer软件；Greve&Fischl，2009)，将MPRAGE和脑分割线性地记录到对象扩散空间(B0)。对于每个起始点，流线沿着两个相反的方向生长，固定的步长等于1 mm。**当流线进入新的体素时，沿着产生最小曲率的ODF最大方向增长。如果方向变化大于60度/毫米，则流水线终止。当流线的两端离开白质面罩时，光路造影术完成。地块之间的结构连通性用流线密度来估计，流线密度的定义是两个地块之间的流线的数量，由流线的平均长度和地块的平均表面积来归一化。**



### 单主体网络和连接共识

![截屏2022-10-30 16.39.59](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 16.39.59.png)   是主体的加权对称结构连通矩阵

其元素Aijs表示脑区i和j之间的归一化流线计数

给定矩阵集合A![截屏2022-10-30 16.42.11](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 16.42.11.png)，我们可以计算**共识矩阵**![截屏2022-10-30 16.43.35](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 16.43.35.png)

然后，直观地，CIj∈[0，1]指示为其表示连接{i，j}的受试者的比例

![截屏2022-10-30 16.45.53](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 16.45.53.png)





集团代表网建设

在这篇文章中，我们比较了几种构建群体代表网络的策略，这些网络用于结构连通性的dMRI估计和使用纤维束造影术重建。在这一节中，我们将介绍几种这样做的方法。

生成代表群体的连接度矩阵的最天真的方法是让每个连接点的权重成为它在所有受试者中的平均值，而忽略那些没有表达连接点的人，即**Aijs=0**。我们将这种方法称为简单平均，并将估计的**群代表连接性矩阵表示为Asimp**，其元素定义为Asimpij=1|T>0|∑s∈T>0Aijs。
这里，T>0是满足Aijs>0的对象的集合![截屏2022-10-30 16.49.47](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 16.49.47.png)



**基于一致性的阈值分割**

一种更常见的生成群体代表性矩阵的方法是**对共识矩阵C的元素施加阈值τ，以便只保留满足Cij≥τ的元素**。

矩阵应该保留在各个主题中一致表达的特征，在这种情况下是联系。在更广泛的以协商一致为基础的阈值框架内，有许多可供执行的战略。在这一节中，我们将重点介绍本文所探讨的内容。

基于共识的阈值最常见的变体是对所有连接施加统一的阈值。也就是说，共识矩阵的所有可能元素都被同时考虑，而那些在Cij≥τ中幸存下来的元素被保留。相反，**受限阈值是其中连接根据某些标准被分组到K个类，并且类相关阈值τ(K)，其中k∈{1，...，K}被分别施加于每个类。**例如，可以根据连接的起点和终止点位于同一半球还是不同半球来对连接进行分类。约束阈值不仅限于有序数据，而且通过离散化也可用于连续变量。例如，**区域间距离是一个连续变量，用来衡量和区域质心之间的欧几里得距离。人们可以通过将可能的欧几里德距离的间隔离散到不重叠的bin中来施加依赖于距离的阈值τ(D)。每个bin将包括跨越特定距离范围的连接，并且可以在每个bin内设置不同的阈值**







注意，对于使用三个基于共识的阈值程序中的任何一个生成的所有组代表网络，连接权重是使用以下两步过程确定的。**首先，从“简单平均”连接性矩阵中为每个保留的连接分配相应的权重。**

**一旦所有连接都被分配了权重，我们就从集合的主题级连接权重中重新分配权重。**因此，结果矩阵的连接权重分布与典型主题的连接权重分布大致相同



**Models tested in this submission**

在这里，我们测试了四种不同的方法来生成群代表网络。
第一种是“简单的”方法，如果在至少一名受试者中观察到这种联系及其平均权重，这种方法就会保持不变。
第二和第三种方法是统一协商一致阈值方法的变体。
其中第一项规定了所有连接的τ=0.5，因此组网络只包括至少一半受试者队列中表达的连接。
第二种方法包括选择一个共识阈值，以使结果网络的二进制密度尽可能接近平均受试者的二进制密度。
我们将这种方法称为τ=Avg方法。
**第四种也是最后一种方法是依赖于距离的阈值。**
**在这种方法中，受试者的边缘长度被合并。**
**给出边及其长度的列表，我们基于边长度百分位数来定义Mbins，其中M是共识网络中的边的总数。**
**下一步，每个面元，我们识别所有可能的边，根据它们的长度，落入面元。**
**在这些可能的优势中，我们选择了跨主题共识最大的一个。**
**如果存在平局，我们选择平均权重最大的边。**
**这一过程生成的网络具有与原始网络大致相同的边长分布，同时选择性地保留了受试者之间高度一致的边缘。**



我们注意到，一般来说，有许多具有不同目的和不同标准的阈值程序来保留或修剪连接。这里，我们集中在一些最常见的阈值程序上，所有这些程序都是在共识矩阵C上操作的。具体地说，**τ=0.5方法可以被认为是常见的“绝对阈值”程序的一种实现，而τ=avg方法则实现了“比例阈值”**。虽然这些程序在网络神经科学文献中是常见的，但它们通常



适用于元素表示连接权重的矩阵，如纤维密度、相关幅度、分数各向异性等。在这里，因为我们的目标是双重的阈值矩阵，但也保留了受试者共同的特征，所以我们将这些阈值处理方法应用于共识矩阵，而不是权重矩阵。目前尚不清楚基于权重的阈值是否是生成具有组代表性的指标的合适方法。这一点应该在今后的工作中进行更明确的调查。



我们注意到，在这里测试的方法中，τ=0.5和距离相关方法具有相同的密度(等于平均受试者的密度)。其他方法，τ=0.5和“简单”方法，都有不同的密度。这具有重要的影响，因为众所周知，网络密度的波动会使许多网络衡量标准产生偏差。因此，只有τ=0.5和距离相关方法具有直接可比性，





**网络措施**

我们使用**一组量化网络拓扑不同方面的指标来比较主题级别和群体代表网络**(所有指标都是使用作为大脑连接工具箱(https://sites.google.com/site/bctnet/；Rubinov&Sporns的一部分提供的函数计算的，2010年)。这些度量包括二进制和加权的总连接权、度、聚类系数(节点和全局)、中间度中心性、效率、路径长度、直径、多尺度模块化、参与系数、匹配性和连接长度。在本节中，我们将更详细地描述这些措施。



**度数和总重量**

在人们可以计算的最简单的结构度量中，给定的关联度矩阵A={aij}是结点i的程度，它概括了其连接的总数(或权重

![截屏2022-10-30 17.21.48](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 17.21.48.png)

给定节点度的向量k={ki}，然后我们可以计算网络的总权重为2m=∑iki(在这种情况下，2的系数是必需的，因为这里所考虑的网络是间接的)



**聚类系数**

![截屏2022-10-30 17.22.45](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 17.22.45.png)

另一个简单的度量是每个节点的聚类系数。i.聚类系数衡量OFI的所有邻居之间的连接密度，计算公式为

其中，i=∑j，hAijAihAi表示节点i周围的三角形的个数。节点级聚类系数可以平均以总结网络的平均聚类，C=1N∑I![截屏2022-10-30 17.25.03](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 17.25.03.png)



![截屏2022-10-30 17.25.32](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 17.25.32.png)



**基于路径的度量：特征路径长度、直径、居中中心度和效率**

![截屏2022-10-30 19.09.50](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.09.50.png)

矩阵，其元素dij等于nodes i和j之间的最短拓扑路的长度。对于二进制网络，最短路径是根据测地线距离计算的，即步数。然而，对于加权网络，最短路径是基于边权重到长度的转换来计算的。在这里，我们使用了一种重到长的转换，即![截屏2022-10-30 19.10.08](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.10.08.png)。一旦计算出最短路径矩阵，我们就可以将特征路径长度定义为![截屏2022-10-30 19.08.51](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.08.51.png)

我们还可以将网络直径定义为



![截屏2022-10-30 19.10.31](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.10.31.png)



最后，我们将效率定义为

![截屏2022-10-30 19.10.49](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.10.49.png)

与最短路径概念相关的度量是介数中心性。设ρ是节点Hj和ρHj之间的最短路径的数目，Hj(I)是通过Nodei的Hh和Jj之间的最短路径的数目。
然后，节点i的介数中心度(它测量通过节点i的所有最短路径的比例)计算如下





**模块化最大化和参与系数**

许多现实世界的网络都采用模块化体系结构，这意味着**它们的节点可以被有意义地分解为子网络(也称为“社区”或“模块”)，这些子网络内部紧密相连，但相互隔离。虽然有许多方法来检测网络中的模块，但最流行的方法之一是模块化最大化**，它通过最大化由变量Q设计的模块化质量函数(Newman&Girvan，2004)，将每个节点划分为K社区σi∈{1，...K}之一。模块化函数具有以下形式![截屏2022-10-30 19.20.15](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.20.15.png)

这里，AijandPij是节点{i，j}之间的连接的观测值和期望值。
双重求和有效地确保和只计算落在社区内的节点对，即σi=σj。因此，当社区内观察到的连接密度最大地大于随机预期时，Q被优化。
在这里，我们设，它对应于一种机会方法，在该方法中，每个结点的度保持不变，但它的连接是随机建立的

![截屏2022-10-30 19.21.46](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.21.46.png)



模块化的标准公式Q受到所谓的“分辨率限制”的影响，使得它不能检测出低于确定的特征尺度的社区

根据网络的整体密度(Fortunato&Barthelemy，2007)。为了绕过此问题，存在模块化函数的参数版本：

![截屏2022-10-30 19.23.25](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-30 19.23.25.png)

这里，γ是结构分辨率参数，它衡量预期权重的相对贡献。实际上，γ的值决定了检测到的社区的规模，γ的小值和大值相应地返回更大或更小的社区。这种参数化不直接解决分辨率限制的问题；它只是改变了低于哪个范围的社区是不可检测的。

优化Q(γ)在计算上很难处理。
然而，存在许多逼近最优解的方法和启发式方法。
其中最常见的是所谓的卢瓦恩算法，该算法在基准测试中既快速又准确(Blondel，Guillaume，Lbiotte，&Lefebvre，2008)。
然而，Louvain算法是随机的，其最优划分的近似性取决于初始条件。
因此，通常重复该算法多次以生成接近最优解的样本

在这里，我们以0.1为增量，在0.7%到2.1%的范围内改变γ。
在每个离散值上，我们使用Louvain算法的推广来优化Q(γ)100次(Jutla，Jeub，&Mucha，2011年)。

模块化最大化生成的划分和相关的社区检测算法可以进一步刻画网络组织和功能的不同方面。
其中一个指标是参与系数，它衡量节点的连接在多大程度上分布在模块之间或集中在自己的模块内(Guimera&Amaral，2005)。
设κiσ表示模σ的连接结点的总权重。
参与系数的计算公式为

![截屏2022-10-31 10.47.29](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 10.47.29.png)

直观地说，距离1越近，i的连接分布在许多不同模块中的程度就越大。值为0表示I的连接集中在几个模块中





**度分类。**

我们还计算了度分类，这是一种量化给定程度的节点倾向于与其他相似程度的节点联系的程度的度量。
直观地说，度分类是网络中每条边的不同端点处的度的皮尔逊相关性，计算公式为

![截屏2022-10-31 11.07.56](/Users/haozhipeng/Library/Application Support/typora-user-images/截屏2022-10-31 11.07.56.png)

这里，i=1，…，M表示网络中的边，而jiandki是由它们的边连接的节点的度。



**连接长度**

最后，我们还计算了连接长度分布。我们将节点之间的连接长度{i，j}定义为质心之间的欧几里得距离这些地区。一般说来，连接是曲线的，不遵循直线距离。然而，在测量欧几里得距离和连接的曲线纤维长度的研究中，发现这些测量高度相关(Betzel，Avena-Koenigsberger等人，2016)。这意味着，虽然欧几里德距离不是连接长度的完美替代，但它是一个非常好的一阶近似

