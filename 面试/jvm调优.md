

<img src="/Users/haozhipeng/Library/Application Support/typora-user-images/image-20241029161426309.png" alt="image-20241029161426309" style="zoom:50%;" />





java -XX:+PrintFlagsFinal -version | grep "GC"

Full GC频繁

考虑**代码中是否加载了不必要的数据（limit 返回，博客只需要用户头像，你查询返回所有用户信息），是否有内存泄漏**



内存空间大相当于大房子，**总的垃圾回收次数会下降**，但是单次垃圾回收时间会变大，在适量增大内存空间时，垃圾回收时间会降低，

### 新生代

新生代**应该尽可能大**【25-50，**因为新生代对象分配和回收成本低，分配时每个线程有自己的缓冲区，减少并发问题，回收时大部分对象朝生夕死，回收的快**】，新生代大小设置【并发请求数*（一次请求耗费空间）】

幸存区大小【保留活跃对象+将晋升对象】不足时分配担保导致提前晋升，很难回收

对于一些肯定要晋升老年代的，减少新生代晋升老年代的次数



### 老年代

先尝试不调优，出现fullgc时，先调优新生代，将老年代内存提高1/3,1/4，设置**cms在老年代占用多少的情况下进行老年代回收，应该小一点，防止留下浮动垃圾过大导致cms并发失败退化成seriesold**





