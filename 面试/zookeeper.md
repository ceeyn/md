



Zookeeperé¢è¯•é¢˜

https://blog.csdn.net/wanghaiping1993/article/details/125396988?ops_request_misc=%257B%2522request%255Fid%2522%253A%25222DF40C04-E0BD-43FA-976F-BADB1C3F2590%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=2DF40C04-E0BD-43FA-976F-BADB1C3F2590&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-19-125396988-null-null.142^v100^pc_search_result_base8&utm_term=ZooKeeper&spm=1018.2226.3001.4187



https://mp.weixin.qq.com/s?__biz=MzI3NzE0NjcwMg%3D%3D&chksm=f36beb7ec41c6268df9ac795636b8ec7a831a2a4776b84499055cfcbc2bb2834b124e1e8b8c5&idx=3&mid=2650142303&scene=27&sn=dbaba0ef4dba03d7dc97bdd08d03ac57&utm_campaign=geek_search&utm_content=geek_search&utm_medium=geek_search&utm_source=geek_search&utm_term=geek_search#wechat_redirect

# ZAB

<img src="/Users/moon/Library/Application Support/typora-user-images/image-20241216163711784.png" alt="image-20241216163711784" style="zoom: 33%;" />

### 1.å´©æºƒæ¢å¤

æ¯ä¸ªèŠ‚ç‚¹æŠ•ç»™è‡ªå·±ï¼Œç„¶åå¹¿æ’­æŠ•ç¥¨ï¼Œæ”¶åˆ°æŠ•ç¥¨åé‡æ–°æ›´æ–°é€‰ç¥¨ï¼ŒæŠ•ç¥¨å†…å®¹ä¸ºï¼ˆidï¼Œzxidï¼‰



### 2.åŸå­å¹¿æ’­

leader ç»´æŠ¤ä¸¤ç§é˜Ÿåˆ—ï¼Œç¬¬ä¸€ç§ä¿å­˜æ¯ä¸ªfolloer çš„æœ€åä¸€ä¸ª zxidï¼Œä¸ºäº†ç»´æŒçº¿æ€§ä¸€è‡´æ€§ï¼Œç¬¬äºŒç§æ˜¯ observer çš„



## 1. å´©æºƒæ¢å¤é˜¶æ®µï¼ˆé€‰ä¸»ï¼‰

è¿™éƒ¨åˆ†æè¿°çš„æ˜¯ ZooKeeper ä¸­ **Leader é€‰ä¸¾** çš„è¿‡ç¨‹ï¼Œå‘ç”Ÿåœ¨ï¼š

- èŠ‚ç‚¹å´©æºƒåé‡å¯
- é›†ç¾¤åˆšåˆšå¯åŠ¨
- Leader æŒ‚æ‰åé‡æ–°é€‰ä¸»

### ğŸ§  æµç¨‹ç®€è¿°ï¼š

> **æ¯ä¸ªèŠ‚ç‚¹ï¼ˆServerï¼‰æŠ•ç»™è‡ªå·±ï¼Œç„¶åå¹¿æ’­é€‰ç¥¨**
>  é€‰ç¥¨å†…å®¹é€šå¸¸åŒ…æ‹¬ï¼š

```
å¤åˆ¶ç¼–è¾‘
<VotedForId, VotedZxid, Epoch>
```

| å­—æ®µ    | å«ä¹‰è¯´æ˜                                      |
| ------- | --------------------------------------------- |
| `id`    | å½“å‰è®¤ä¸ºçš„ Leader ID                          |
| `zxid`  | å½“å‰èŠ‚ç‚¹çš„äº‹åŠ¡ IDï¼ˆZooKeeper Transaction IDï¼‰ |
| `epoch` | é€‰ä¸¾è½®æ•°ï¼ˆé€»è¾‘æ—¶é’Ÿï¼‰                          |

### âœ… æŠ•ç¥¨è§„åˆ™ï¼š

æ¯ä¸ªèŠ‚ç‚¹ä¼šæ ¹æ®æŠ•ç¥¨è§„åˆ™é€‰å‡ºã€Œçœ‹èµ·æ¥æœ€å…ˆè¿›ã€çš„èŠ‚ç‚¹ä½œä¸º Leader å€™é€‰ï¼š

> è°çš„ `epoch` æ›´å¤§ï¼Œä¼˜å…ˆ
>  å¦‚æœç›¸åŒï¼Œå†æ¯” `zxid`
>  å¦‚æœå†ç›¸åŒï¼Œå†æ¯” server idï¼ˆèŠ‚ç‚¹ idï¼‰

æœ€ç»ˆï¼Œæ”¶åˆ°è¶…è¿‡åŠæ•°æŠ•ç¥¨æ—¶ï¼Œæˆä¸º Leaderã€‚

------

## âœ… 2. åŸå­å¹¿æ’­é˜¶æ®µï¼ˆZab åè®®ï¼‰

ZooKeeper é€‰å‡º Leader åï¼Œè¿›å…¥ **åŸå­å¹¿æ’­é˜¶æ®µ**ï¼Œç”¨äºåˆ†å¸ƒå¼ä¸€è‡´æ€§å†™å…¥ã€‚

ä½ æåˆ°çš„ï¼š

> â€œLeader ç»´æŠ¤ä¸¤ç§é˜Ÿåˆ—ï¼Œä¸€ç§ä¿å­˜ follower çš„ zxidï¼Œä¸ºäº†çº¿æ€§ä¸€è‡´æ€§ï¼Œå¦ä¸€ç§æ˜¯ observer çš„é˜Ÿåˆ—â€

æˆ‘ä»¬æ¥è¯¦ç»†è®²è§£ ğŸ‘‡

------

### âœ… Leader ç»´æŠ¤çš„ä¸¤ç§é˜Ÿåˆ—ï¼š

------

### **ï¼ˆ1ï¼‰Follower ACK é˜Ÿåˆ—ï¼ˆæ ¸å¿ƒï¼‰**

- Leader ä¼šæŠŠæ¯æ¡äº‹åŠ¡ï¼ˆProposalï¼‰å¹¿æ’­ç»™æ‰€æœ‰ followerï¼ˆå‚ä¸æŠ•ç¥¨çš„èŠ‚ç‚¹ï¼‰
- æ¯ä¸ª follower æ”¶åˆ°åè¿”å› ACKï¼ˆç¡®è®¤ï¼‰
- Leader åªæœ‰åœ¨ **æ”¶åˆ°è¶…è¿‡åŠæ•°çš„ ACK åï¼Œæ‰ä¼šæäº¤ï¼ˆcommitï¼‰è¿™æ¡äº‹åŠ¡**

#### âœ¨ ç‰¹ç‚¹ï¼š

- ä¿è¯äº† **çº¿æ€§ä¸€è‡´æ€§**ã€åªæœ‰leaderå¯ä»¥è¿›è¡Œå†™æ“ä½œï¼Œæ²¡æœ‰é€‰å‡ºleaderçš„æ—¶å€™å†™æ“ä½œä¸å¯ç”¨ã€‘
- æ‰€æœ‰ follower éƒ½æ‰§è¡Œç›¸åŒçš„äº‹åŠ¡ã€é¡ºåºä¸€è‡´
- è¿™å°±æ˜¯ ZooKeeper çš„ã€ŒåŸå­å¹¿æ’­ã€

------

### **ï¼ˆ2ï¼‰Observer é˜Ÿåˆ—ï¼ˆåªè¯»èŠ‚ç‚¹ï¼‰**

- Observer æ˜¯åªè¯»èŠ‚ç‚¹ï¼Œä¸å‚ä¸æŠ•ç¥¨å’Œé€‰ä¸¾
- æ¥æ”¶æ¥è‡ª Leader çš„äº‹åŠ¡é€šçŸ¥ï¼Œä½†ä¸ä¼šè¿”å› ACK
- Leader ç»´æŠ¤ä¸€ä¸ªå•ç‹¬çš„ Observer é€šçŸ¥é˜Ÿåˆ—ï¼Œ**åªç”¨äºåŒæ­¥æ•°æ®**

#### âœ¨ ç‰¹ç‚¹ï¼š

- Observer ä¸å½±å“ä¸€è‡´æ€§
- å¯æ¨ªå‘æ‰©å±•é›†ç¾¤çš„è¯»èƒ½åŠ›

------

## ğŸ”„ æ•´ä½“æµç¨‹æ¢³ç†ä¸€ä¸‹ï¼š

1. **Leader æ”¶åˆ°å®¢æˆ·ç«¯å†™è¯·æ±‚**
2. å°†äº‹åŠ¡åŒ…è£…ä¸º Proposalï¼ˆå¸¦ zxidï¼‰ï¼Œå¹¿æ’­ç»™æ‰€æœ‰ follower
3. æ”¶åˆ°åŠæ•°ä»¥ä¸Š follower çš„ ACK
4. Leader æ‰§è¡Œ commitï¼Œé€šçŸ¥æ‰€æœ‰ follower å’Œ observer æäº¤
5. å®¢æˆ·ç«¯æ”¶åˆ°å†™å…¥æˆåŠŸå“åº”

------

## çº¿æ€§ä¸€è‡´æ€§

```
ä½ å¯¹ ZooKeeper åšä¸¤æ¬¡å†™æ“ä½œï¼š

plaintext
å¤åˆ¶
ç¼–è¾‘
Client A: set /node1 = "X"
Client B: get /node1
å¦‚æœæ˜¯çº¿æ€§ä¸€è‡´æ€§ï¼ŒB ä¸€å®šèƒ½çœ‹åˆ° "X"ã€‚

å³ä½¿ A å’Œ B æ˜¯ä¸åŒæœºå™¨å‘èµ·çš„ã€è¯·æ±‚é¡ºåºéå¸¸è¿‘ï¼Œåªè¦ B æ˜¯åœ¨ A ä¹‹åå‘çš„ï¼Œå°±å¿…é¡»çœ‹åˆ°æœ€æ–°çš„å€¼ï¼Œä¸èƒ½çœ‹åˆ°æ—§å€¼ã€‚


```

### å…³é”®ç‚¹ï¼š**ZooKeeper æ‰€æœ‰å†™è¯·æ±‚éƒ½å¿…é¡»ç”± Leader æ¥å¤„ç†ï¼**

- Follower èŠ‚ç‚¹ä¸èƒ½æ¥æ”¶å†™è¯·æ±‚
- æ‰€æœ‰å†™æ“ä½œéƒ½é€šè¿‡ Leader å‘èµ·åŸå­å¹¿æ’­ï¼ˆZabï¼‰
- æ²¡æœ‰ Leaderï¼Œå°±**æ²¡æœ‰åŠæ³•ç¡®ä¿çº¿æ€§ä¸€è‡´æ€§**



## åŒæ­¥æ˜¯followerå‘é€æœ€åä¸€ä¸ªzxidæ¥è¿›è¡Œçš„

### âœ… æ­¥éª¤ 1ï¼šFollower è¿æ¥ Leaderï¼Œå‘é€è‡ªå·±çš„æœ€æ–°äº‹åŠ¡ IDï¼ˆlastZxidï¼‰

æ¯ä¸ª Follower æœ¬åœ°ä¼šä¿å­˜å®ƒæ‰§è¡Œè¿‡çš„æœ€åä¸€ä¸ªäº‹åŠ¡çš„ç¼–å·ï¼ˆ`lastZxid`ï¼‰ï¼Œä¾‹å¦‚ï¼š

```
plaintext


å¤åˆ¶ç¼–è¾‘
Follower A çš„ lastZxid = 0x300000004 ï¼ˆç¬¬3ä»£ Leaderï¼Œæ“ä½œåºå·=4ï¼‰
```

å®ƒä¼šåœ¨å¯åŠ¨æ—¶å‘ Leader å‘é€ä¸€ä¸ªåŒ…å«è¯¥å€¼çš„ `FOLLOWERINFO` åŒ…ã€‚

------

### âœ… æ­¥éª¤ 2ï¼šLeader å¯¹æ¯”è‡ªå·±çš„äº‹åŠ¡æ—¥å¿—

Leader æ”¶åˆ° Follower çš„ lastZxid åï¼Œä¼šå¯¹æ¯”ï¼š

- è‡ªå·±å½“å‰æœ€æ–°äº‹åŠ¡çš„ zxidï¼ˆæ¯”å¦‚ 0x300000007ï¼‰
- å’Œ Follower æä¾›çš„ zxidï¼ˆ0x300000004ï¼‰

å‘ç°ï¼šFollower åªç¼ºå°‘ `zxid = 0x300000005 ~ 0x300000007` è¿™ä¸‰æ¡äº‹åŠ¡ã€‚

```
Follower           Leader
  zxid=4           zxid=7
    â”‚                â”‚
    â””â”€ FOLLOWERINFO  â”€â”€â”€â–¶ å‘é€ 4
                      â”‚
             Leader çŸ¥é“ä½ å·®äº† 5~7
                      â”‚
    â—€â”€ Proposal(5) â—€â”€â”€â”€
    â—€â”€ Proposal(6) â—€â”€â”€â”€
    â—€â”€ Proposal(7) â—€â”€â”€â”€

```





### 3. **æ€»ç»“å¯¹æ¯”**

| ç‰¹æ€§                 | **ZooKeeper**                                  | **Nginx**                                      |
| -------------------- | ---------------------------------------------- | ---------------------------------------------- |
| **å•ç‚¹æ•…éšœ**         | æ— å•ç‚¹æ•…éšœï¼Œé€šè¿‡ ZAB åè®®ä¿è¯é«˜å¯ç”¨æ€§          | å­˜åœ¨å•ç‚¹æ•…éšœï¼Œéœ€è¦é€šè¿‡ KeepAlived å®ç°é«˜å¯ç”¨æ€§ |
| **é«˜å¯ç”¨æ€§å®ç°æ–¹å¼** | é€šè¿‡ Quorum æœºåˆ¶å’Œ Leader é€‰ä¸¾ä¿è¯é«˜å¯ç”¨æ€§     | ä½¿ç”¨ KeepAlived æˆ– LVS è¿›è¡Œæ•…éšœåˆ‡æ¢å’Œè´Ÿè½½å‡è¡¡  |
| **æ•…éšœå¤„ç†æœºåˆ¶**     | Leader å®•æœºæ—¶è‡ªåŠ¨é€‰ä¸¾æ–°çš„ Leaderï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„ | é€šè¿‡ VIP å®ç°ä¸»å¤‡åˆ‡æ¢ï¼Œå¤‡ç”¨èŠ‚ç‚¹æ¥ç®¡æµé‡        |
| **ä¼˜ç‚¹**             | ä¸å­˜åœ¨æµé‡ä¸­æ–­ï¼Œé€‰ä¸¾è¿‡ç¨‹å¿«é€Ÿç¨³å®š               | é€šè¿‡å¤šä¸ªèŠ‚ç‚¹å®ç°æµé‡åˆ‡æ¢ï¼Œä¿è¯æœåŠ¡ä¸ä¸­æ–­       |
| **é€‚ç”¨åœºæ™¯**         | åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åè°ƒæœåŠ¡                         | æµé‡è°ƒåº¦ã€åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡                   |

### 4. **è¿›ä¸€æ­¥æ‰©å±•**

ZooKeeper é€šè¿‡åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ï¼ˆå¦‚ ZAB åè®®ï¼‰æ¥å®ç°å¼ºä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œè€Œ Nginx ä¸»è¦ä¾èµ–é«˜å¯ç”¨æ€§å·¥å…·ï¼ˆå¦‚ KeepAlivedï¼‰æ¥ä¿è¯æœåŠ¡ä¸ä¸­æ–­ã€‚å¯¹äºéœ€è¦å¤§è§„æ¨¡æœåŠ¡åè°ƒçš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼ŒZooKeeper èƒ½å¤Ÿæä¾›æ— å•ç‚¹æ•…éšœçš„é«˜å¯ç”¨æ¶æ„ã€‚è€Œåœ¨ Web åº”ç”¨å’Œæµé‡è°ƒåº¦åœºæ™¯ä¸‹ï¼ŒNginx é€šè¿‡ KeepAlived è¿™æ ·çš„å·¥å…·èƒ½å¤Ÿæœ‰æ•ˆè§£å†³å•ç‚¹é—®é¢˜ï¼Œå®ç°é«˜å¯ç”¨çš„åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚



https://blog.csdn.net/kangbin825/article/details/140008963

Eureka æ˜¯ Netflix å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸å‘ç°æ¡†æ¶ï¼Œä¸»è¦ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­è§£å†³æœåŠ¡çš„åŠ¨æ€æ³¨å†Œå’Œå‘ç°é—®é¢˜ã€‚ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Š Eureka çš„ç‰¹ç‚¹ã€å·¥ä½œåŸç†ä»¥åŠè®¾è®¡ç†å¿µï¼Œé‡ç‚¹çªå‡ºå…¶ä¸ CAP åŸåˆ™çš„å…³ç³»ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ç­‰ç‰¹æ€§æ¥å®ç°é«˜å¯ç”¨æ€§ã€‚

### 1. **Eureka çš„ç‰¹ç‚¹**

#### 1.1 **å¯ç”¨æ€§ï¼ˆAP åŸåˆ™ï¼‰**
- **CAP åŸåˆ™** ä¸­çš„ä¸‰ç§å±æ€§åˆ†åˆ«æ˜¯ï¼š**ä¸€è‡´æ€§ï¼ˆC: Consistencyï¼‰**ï¼Œ**å¯ç”¨æ€§ï¼ˆA: Availabilityï¼‰** å’Œ **åˆ†åŒºå®¹å¿æ€§ï¼ˆP: Partition Toleranceï¼‰**ã€‚æ ¹æ® CAP åŸåˆ™ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ— æ³•åŒæ—¶å®Œå…¨ä¿è¯ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ï¼Œå› æ­¤å¿…é¡»åœ¨ä¸‰è€…ä¹‹é—´åšå‡ºæƒè¡¡ã€‚
- **Eureka** åœ¨è®¾è®¡æ—¶éµå¾ªäº† **AP åŸåˆ™**ï¼Œå³ **å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ä¼˜å…ˆ**ï¼Œè€Œç‰ºç‰²äº†ä¸€éƒ¨åˆ†ä¸€è‡´æ€§ã€‚è¿™æ„å‘³ç€ï¼š
  - **Eureka** ç¡®ä¿å³ä½¿æŸäº›èŠ‚ç‚¹ä¸å¯ç”¨ï¼ŒæœåŠ¡æ³¨å†Œä¸­å¿ƒä»ç„¶èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚
  - ä½†æ˜¯ï¼ŒæœåŠ¡çš„æ³¨å†Œä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€å®æ—¶çš„ï¼Œå¯èƒ½å­˜åœ¨çŸ­æš‚çš„æ•°æ®ä¸ä¸€è‡´æ€§ã€‚

#### 1.2 **å»ä¸­å¿ƒåŒ–æ¶æ„**
- Eureka çš„æ¶æ„æ˜¯ **å»ä¸­å¿ƒåŒ–** çš„ï¼Œé‡‡ç”¨äº† **Peer to Peer å¯¹ç­‰é€šä¿¡** çš„æ¨¡å¼ï¼Œè€Œä¸æ˜¯åƒ ZooKeeper é‚£æ ·çš„ä¸»ä»ï¼ˆMaster-Slaveï¼‰ç»“æ„ã€‚æ‰€æœ‰ Eureka Server å®ä¾‹éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œæ²¡æœ‰ Leader å’Œ Follower çš„åŒºåˆ«ã€‚
- è¿™ç§è®¾è®¡ä½¿å¾— **Eureka** æ›´åŠ çµæ´»ï¼Œèƒ½å¤Ÿé¿å…å•ç‚¹æ•…éšœçš„é—®é¢˜ã€‚æ¯ä¸ª Eureka Server èŠ‚ç‚¹éƒ½å¯ä»¥ç‹¬ç«‹å·¥ä½œï¼Œå³ä½¿æŸäº›èŠ‚ç‚¹å®•æœºï¼Œå…¶ä»–èŠ‚ç‚¹ä»ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚

#### 1.3 **è¯·æ±‚è‡ªåŠ¨åˆ‡æ¢**
- å½“ä¸€ä¸ª **Eureka Server** èŠ‚ç‚¹å®•æœºæ—¶ï¼ŒEureka Client å¯ä»¥è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–å¯ç”¨çš„ Eureka Server èŠ‚ç‚¹ç»§ç»­å·¥ä½œã€‚Eureka Client ä¼šå®šæœŸåˆ·æ–°æ³¨å†Œä¿¡æ¯ï¼Œå¹¶ä¸”ç»´æŠ¤å¤šä¸ª Eureka Server åœ°å€ï¼Œå½“å®•æœºçš„èŠ‚ç‚¹æ¢å¤åï¼ŒClient ä¼šé‡æ–°å°†å…¶çº³å…¥åˆ°æœåŠ¡å‘ç°çš„æµç¨‹ä¸­ã€‚
- è¿™ç§è‡ªåŠ¨åˆ‡æ¢æœºåˆ¶ä¿è¯äº†æ³¨å†Œä¸­å¿ƒçš„é«˜å¯ç”¨æ€§ï¼Œé¿å…äº†å› ä¸ºæŸä¸ªèŠ‚ç‚¹å®•æœºè€Œå¯¼è‡´æœåŠ¡å‘ç°çš„ä¸­æ–­ã€‚

#### 1.4 **èŠ‚ç‚¹é—´çš„æ“ä½œå¤åˆ¶**
- å½“ä¸€ä¸ª Eureka Server æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„æœåŠ¡æ³¨å†Œæˆ–æ³¨é”€è¯·æ±‚æ—¶ï¼Œå®ƒä¼šå°†è¿™ä¸ªæ“ä½œå¤åˆ¶åˆ°é›†ç¾¤ä¸­å…¶ä»–æ‰€æœ‰ Eureka Server èŠ‚ç‚¹ã€‚è¿™ç¡®ä¿äº†é›†ç¾¤ä¸­æ¯ä¸ª Eureka Server çš„æ³¨å†Œä¿¡æ¯ä¿æŒä¸€è‡´ï¼ˆå°½ç®¡å¤åˆ¶è¿‡ç¨‹å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿï¼‰ã€‚
- è¿™ç§æ“ä½œå¤åˆ¶æœºåˆ¶ä¿è¯äº†æ³¨å†Œä¿¡æ¯çš„å†—ä½™å­˜å‚¨ï¼Œé¿å…äº†å•ç‚¹æ•…éšœçš„é£é™©ã€‚

#### 1.5 **è‡ªåŠ¨æ³¨å†Œå’Œå¿ƒè·³**
- Eureka Client åœ¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨å‘ Eureka Server æ³¨å†ŒæœåŠ¡ï¼Œå¹¶ä¸”æ¯éš” 30 ç§’å‘é€ä¸€æ¬¡å¿ƒè·³ï¼Œå‘ŠçŸ¥ Eureka Server è‡ªå·±çš„å¥åº·çŠ¶æ€ã€‚
- å¦‚æœ Eureka Server åœ¨ 90 ç§’å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªæœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼Œå®ƒå°†è®¤ä¸ºè¯¥å®ä¾‹ä¸å¯ç”¨ï¼Œå¹¶å°†å…¶ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤ã€‚

#### 1.6 **è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼**
- **è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼** æ˜¯ Eureka ä¸ºäº†æé«˜å¯ç”¨æ€§è€Œè®¾è®¡çš„ä¸€ä¸ªå®¹é”™æœºåˆ¶ã€‚
  - å½“ Eureka Server å‘ç°å¤§é‡ Eureka Client çš„å¿ƒè·³åœ¨çŸ­æ—¶é—´å†…æ¶ˆå¤±ï¼ˆä¾‹å¦‚ç½‘ç»œåˆ†åŒºæ—¶ï¼‰ï¼Œå®ƒä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚
  - åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸‹ï¼ŒEureka ä¸ä¼šä¸»åŠ¨åˆ é™¤æ²¡æœ‰å‘é€å¿ƒè·³çš„æœåŠ¡å®ä¾‹ï¼Œè€Œæ˜¯ç»§ç»­å…è®¸è¿™äº›å®ä¾‹æä¾›æœåŠ¡ã€‚è¿™ç§æœºåˆ¶é¿å…äº†ç”±äºç½‘ç»œé—®é¢˜å¯¼è‡´çš„æœåŠ¡è¿‡æ—©ä¸‹çº¿ã€‚
  - ä¸€æ—¦ç½‘ç»œæ¢å¤ï¼ŒEureka ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œé‡æ–°è¿›è¡Œæ³¨å†Œè¡¨çš„åŒæ­¥ã€‚

#### 1.7 **ä¿æŠ¤æ¨¡å¼ç»†èŠ‚**
- **ä¿æŠ¤æ¨¡å¼** ä¸»è¦å¤„ç†ç½‘ç»œæŠ–åŠ¨æˆ–å¤§è§„æ¨¡ç½‘ç»œé—®é¢˜ã€‚Eureka é€šè¿‡ç»Ÿè®¡çŸ­æ—¶é—´å†…å¿ƒè·³ä¸¢å¤±çš„æ¯”ä¾‹ï¼ˆé»˜è®¤æ˜¯ 15 åˆ†é’Ÿå†…è¶…è¿‡ 85% çš„å¿ƒè·³ä¸¢å¤±ï¼‰æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦è¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚
  - å½“æ£€æµ‹åˆ°å¤§é‡çš„å®¢æˆ·ç«¯å¿ƒè·³ä¸¢å¤±æ—¶ï¼ŒEureka ä¸ä¼šåˆ é™¤è¿™äº›æœåŠ¡å®ä¾‹çš„ä¿¡æ¯ï¼Œä»ç„¶å…è®¸å…¶ä»–æœåŠ¡ç»§ç»­è¿›è¡Œæ³¨å†Œå’ŒæŸ¥è¯¢ï¼Œä½†æ–°çš„æ³¨å†Œä¿¡æ¯ä¸ä¼šç«‹å³åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚ã€é˜²æ­¢å› ç½‘ç»œä¸ç¨³å®šå¯¼è‡´æ•°æ®æ··ä¹±æˆ–ä¸¢å¤±ã€‚ã€‘
  - è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå³ä½¿åœ¨å‡ºç°ç½‘ç»œå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼ŒEureka ä»ç„¶å¯ä»¥ä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼Œä¿è¯äº†ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚

### 2. **Eureka å·¥ä½œåŸç†**

Eureka çš„æ ¸å¿ƒå·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š

1. **Eureka Server å¯åŠ¨**
   - å½“ Eureka Server å¯åŠ¨åï¼Œå®ƒä¼šé€šè¿‡é›†ç¾¤ä¸­çš„å…¶ä»– Eureka Server åŒæ­¥æœåŠ¡æ³¨å†Œè¡¨ï¼Œç¡®ä¿è‡ªå·±æ‹¥æœ‰å®Œæ•´çš„æ³¨å†Œè¡¨ä¿¡æ¯ã€‚å¦‚æœæ˜¯ç‹¬ç«‹çš„ Serverï¼Œå®ƒä¼šç­‰å¾…æœåŠ¡ç«¯çš„æ³¨å†Œã€‚
   
2. **Eureka Client æ³¨å†Œ**
   - Eureka Client åœ¨å¯åŠ¨æ—¶ï¼Œä¼šæ ¹æ®é…ç½®çš„ Eureka Server åœ°å€ï¼Œå°†è‡ªèº«çš„æœåŠ¡ä¿¡æ¯æ³¨å†Œåˆ° Eureka Server ä¸­ã€‚
   - å®¢æˆ·ç«¯ä¼šå‘¨æœŸæ€§åœ°å‘é€ **å¿ƒè·³è¯·æ±‚**ï¼ˆé»˜è®¤ 30 ç§’ï¼‰ï¼Œä»¥ç¡®ä¿è‡ªå·±å¤„äºå¥åº·çŠ¶æ€ã€‚

3. **å¿ƒè·³æ£€æµ‹ä¸å®ä¾‹æ³¨é”€**
   - å¦‚æœ Eureka Server åœ¨ 90 ç§’å†…æ²¡æœ‰æ”¶åˆ°æŸä¸ªæœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼Œå®ƒä¼šè®¤ä¸ºè¯¥å®ä¾‹ä¸å¯ç”¨ï¼Œå¹¶å°†å…¶ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤ã€‚
   
4. **è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶**
   - å½“ Eureka Server åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±äº†å¤§é‡çš„å¿ƒè·³æ—¶ï¼Œå®ƒä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œä¿æŒå·²æ³¨å†Œçš„æœåŠ¡å®ä¾‹ï¼Œè€Œä¸ä¼šç«‹å³å°†å…¶ç§»é™¤ã€‚è¿™ç§æœºåˆ¶ä¿è¯äº†åœ¨ç½‘ç»œæŠ–åŠ¨æˆ–åˆ†åŒºæƒ…å†µä¸‹çš„é«˜å¯ç”¨æ€§ã€‚
   
5. **æœåŠ¡è°ƒç”¨**
   - å½“æŸä¸ªæœåŠ¡éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡æ—¶ï¼Œå®ƒä¼šé¦–å…ˆä»æœ¬åœ°ç¼“å­˜ä¸­è·å–æœåŠ¡ä¿¡æ¯ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåˆ™ä¼šå‘ Eureka Server è¯·æ±‚æœ€æ–°çš„æœåŠ¡æ³¨å†Œè¡¨ã€‚
   - å®¢æˆ·ç«¯ä¼šå‘¨æœŸæ€§åœ°ä» Eureka Server æ‹‰å–æœ€æ–°çš„æœåŠ¡æ³¨å†Œè¡¨ï¼Œä»¥ä¿æŒç¼“å­˜ä¸­çš„æœåŠ¡ä¿¡æ¯ä¸æ³¨å†Œä¸­å¿ƒä¸€è‡´ã€‚
   
6. **æœåŠ¡æ³¨é”€**
   - å½“å®¢æˆ·ç«¯å…³é—­æ—¶ï¼Œå®ƒä¼šå‘ Eureka Server å‘é€ä¸€ä¸ªå–æ¶ˆæ³¨å†Œçš„è¯·æ±‚ï¼ŒEureka Server å°†è¯¥å®ä¾‹ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤ã€‚

### 3. **Eureka çš„ä¼˜åŠ¿**

#### 3.1 **é«˜å¯ç”¨æ€§**
- é€šè¿‡å»ä¸­å¿ƒåŒ–çš„æ¶æ„å’Œ Peer to Peer å¯¹ç­‰é€šä¿¡æœºåˆ¶ï¼ŒEureka å¯ä»¥é¿å…å•ç‚¹æ•…éšœï¼Œå¹¶é€šè¿‡è‡ªåŠ¨åˆ‡æ¢æœºåˆ¶ä¿è¯é›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å®•æœºæ—¶ï¼Œå®¢æˆ·ç«¯ä¾ç„¶èƒ½å¤Ÿæ‰¾åˆ°å…¶ä»–èŠ‚ç‚¹ç»§ç»­å·¥ä½œã€‚

#### 3.2 **å¯æ‰©å±•æ€§**
- ç”±äºæ¯ä¸ª Eureka Server éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œå› æ­¤ Eureka çš„é›†ç¾¤å¯ä»¥é€šè¿‡æ·»åŠ æ›´å¤šçš„ Server å®ä¾‹æ¥å®ç°æ°´å¹³æ‰©å±•ï¼Œå¢å¼ºç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå®¹é”™èƒ½åŠ›ã€‚

#### 3.3 **è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶**
- è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä½¿å¾— Eureka èƒ½å¤Ÿå®¹å¿ä¸´æ—¶çš„ç½‘ç»œæ•…éšœï¼Œé¿å…å› çŸ­æš‚çš„ç½‘ç»œé—®é¢˜å¯¼è‡´å¤§é‡æœåŠ¡å®ä¾‹è¢«é”™è¯¯åœ°ç§»é™¤ï¼Œä¿è¯äº†æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„å¯ç”¨æ€§ã€‚

#### 3.4 **é€‚åˆè·¨æœºæˆ¿éƒ¨ç½²**
- Eureka è®¾è®¡ä¸Šä¸è¿½æ±‚å¼ºä¸€è‡´æ€§ï¼Œè€Œæ˜¯ä¿è¯äº†é«˜å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ã€‚å› æ­¤ï¼Œå®ƒéå¸¸é€‚åˆéƒ¨ç½²åœ¨è·¨å¤šä¸ªæœºæˆ¿çš„ç¯å¢ƒä¸­ï¼Œå³ä½¿æœºæˆ¿é—´çš„ç½‘ç»œå‡ºç°é—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„å¯ç”¨æ€§ã€‚

### 4. **Eureka å’Œ ZooKeeper çš„åŒºåˆ«**

#### 4.1 **ä¸€è‡´æ€§ vs å¯ç”¨æ€§**
- **ZooKeeper**ï¼šæ›´å¼ºè°ƒ **ä¸€è‡´æ€§**ï¼Œä½¿ç”¨çš„æ˜¯ CP æ¨¡å‹ï¼ˆConsistency å’Œ Partition Toleranceï¼‰ã€‚åœ¨ ZooKeeper ä¸­ï¼Œç½‘ç»œåˆ†åŒºä¼šå¯¼è‡´é€‰ä¸¾ Leaderï¼ŒæœŸé—´æœåŠ¡å¯èƒ½æ— æ³•å¤„ç†è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§ã€‚
- **Eureka**ï¼šæ›´å¼ºè°ƒ **å¯ç”¨æ€§**ï¼Œä½¿ç”¨çš„æ˜¯ AP æ¨¡å‹ï¼ˆAvailability å’Œ Partition Toleranceï¼‰ã€‚Eureka é€šè¿‡ç‰ºç‰²æ•°æ®ä¸€è‡´æ€§ï¼Œæ¥ä¿è¯æ³¨å†Œä¸­å¿ƒåœ¨ç½‘ç»œåˆ†åŒºç­‰å¼‚å¸¸æƒ…å†µä¸‹ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚

#### 4.2 **ä¸­å¿ƒåŒ– vs å»ä¸­å¿ƒåŒ–**
- **ZooKeeper** ä¾èµ–äºä¸­å¿ƒåŒ–çš„ Leader-Follower æ¶æ„ï¼ŒLeader è´Ÿè´£æ‰€æœ‰å†™æ“ä½œã€‚
- **Eureka** é‡‡ç”¨å»ä¸­å¿ƒåŒ–çš„ Peer to Peer æ¶æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œä¸éœ€è¦è¿›è¡Œ Leader é€‰ä¸¾ã€‚

### æ€»ç»“

**Eureka** æ˜¯ä¸€ä¸ªé«˜å¯ç”¨ã€å»ä¸­å¿ƒåŒ–çš„æœåŠ¡æ³¨å†Œä¸å‘ç°å·¥å…·ï¼Œå®ƒé‡‡ç”¨ AP åŸåˆ™ï¼Œé€šè¿‡ç‰ºç‰²ä¸€è‡´æ€§ï¼Œæ¥ç¡®ä¿æ³¨å†Œä¸­å¿ƒåœ¨ç½‘ç»œæ•…éšœæˆ–èŠ‚ç‚¹å®•æœºæ—¶ä¾ç„¶èƒ½å¤Ÿæä¾›æœåŠ¡ã€‚å…¶ **è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶**ã€**è‡ªåŠ¨åˆ‡æ¢** å’Œ **å»ä¸­å¿ƒåŒ–æ¶æ„** ä½¿å¾—å®ƒéå¸¸é€‚åˆåœ¨é«˜å¯ç”¨æ€§è¦æ±‚è¾ƒé«˜ã€è·¨å¤šä¸ªæœºæˆ¿çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨ã€‚



```
Eureka çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶æ˜¯ä¸€ä¸ªå…³é”®çš„åŠŸèƒ½ï¼Œå®ƒçš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å¢å¼ºæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„å¯ç”¨æ€§å’Œå¥å£®æ€§ã€‚è¿™ç§æœºåˆ¶ç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œè¿™äº›ç¯å¢ƒå¯èƒ½ä¼šé‡åˆ°ä¸ç¨³å®šçš„ç½‘ç»œæƒ…å†µæˆ–è€…å¤§é‡æœåŠ¡å®ä¾‹çš„åŒæ—¶å¤±è´¥ã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸ºä»€ä¹ˆ Eureka ä¼šé‡‡ç”¨è¿™æ ·çš„è®¾è®¡ï¼š

### 1. é˜²æ­¢ç½‘ç»œåˆ†åŒºå¯¼è‡´çš„æœåŠ¡ä¸‹çº¿

åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒæœåŠ¡å®ä¾‹é€šå¸¸åˆ†å¸ƒåœ¨å¤šä¸ªç½‘ç»œåŒºåŸŸã€‚å½“æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆEureka Serverï¼‰ç”±äºç½‘ç»œé—®é¢˜æš‚æ—¶æ— æ³•ä¸ä¸€éƒ¨åˆ†æœåŠ¡å®ä¾‹é€šä¿¡æ—¶ï¼ˆç½‘ç»œåˆ†åŒºï¼‰ï¼Œå®ƒå¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¿™äº›æ— æ³•é€šä¿¡çš„æœåŠ¡å®ä¾‹å·²å®é™…å¤±æ•ˆï¼Œå¯¼è‡´å®ƒä»¬è¢«é”™è¯¯åœ°ä»æ³¨å†Œè¡¨ä¸­å‰”é™¤ã€‚è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä½¿å¾— Eureka åœ¨æ£€æµ‹åˆ°è¿™ç§å¼‚å¸¸æƒ…å†µæ—¶ï¼Œä¸ä¼šç«‹å³å‰”é™¤è¿™äº›æœåŠ¡å®ä¾‹ï¼Œä»è€Œé¿å…å› æš‚æ—¶çš„ç½‘ç»œé—®é¢˜è€Œå¯¼è‡´å¤§è§„æ¨¡æœåŠ¡ä¸‹çº¿ï¼Œè¿™å¯¹ä¿æŒæ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§è‡³å…³é‡è¦ã€‚

### 2. ç»´æŠ¤æœåŠ¡çš„é«˜å¯ç”¨æ€§

è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ç¡®ä¿å³ä½¿åœ¨ç½‘ç»œä¸ç¨³å®šæˆ– Eureka Server é­é‡åˆ°å¼‚å¸¸é«˜çš„å¤±è´¥æ£€æµ‹æ—¶ï¼Œå®¢æˆ·ç«¯ä»èƒ½ä» Eureka è·å–åˆ°æ³¨å†Œçš„æœåŠ¡å®ä¾‹åˆ—è¡¨ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿éƒ¨åˆ†æœåŠ¡å®ä¾‹å·²å®é™…å¤±æ•ˆï¼Œå®ƒä»¬ä»æ—§åœ¨æ³¨å†Œè¡¨ä¸­å¯è§ï¼Œè¿™å…è®¸å®¢æˆ·ç«¯åœ¨è¿™äº›å®ä¾‹æ¢å¤ä¹‹å‰ï¼Œæœ‰æ›´å¤šçš„æ—¶é—´å»å¤„ç†æˆ–è¿ç§»è¯·æ±‚åˆ°å…¶ä»–å¥åº·å®ä¾‹ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿæ•´ä½“çš„ä¸å¯ç”¨æ—¶é—´ã€‚

### 3. ä¿æŒæ³¨å†Œè¡¨çš„å®Œæ•´æ€§

é€šè¿‡è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼ŒEureka Server åœ¨é‡åˆ°å¤§è§„æ¨¡æœåŠ¡å®ä¾‹å¿ƒè·³å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œä¼šå°½é‡ä¿æŒå½“å‰çš„æœåŠ¡æ³¨å†Œè¡¨çŠ¶æ€ï¼Œé¿å…å› ä¸ºå¿ƒè·³è¶…æ—¶è€Œæ¸…ç©ºæœåŠ¡åˆ—è¡¨ã€‚è¿™ç§ç­–ç•¥æ˜¯åŸºäºä¸€ä¸ªå‡è®¾ï¼Œå³â€œç½‘ç»œæ•…éšœæ¯”æœåŠ¡å®ä¾‹åŒæ—¶å¤§è§„æ¨¡ä¸‹çº¿çš„å¯èƒ½æ€§è¦é«˜â€ï¼Œè¿™é€šå¸¸æ˜¯åˆç†çš„ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚

### 4. é€æ¸æ¢å¤æ­£å¸¸çŠ¶æ€

ä¸€æ—¦ç½‘ç»œé—®é¢˜è§£å†³ï¼Œé‚£äº›ä¹‹å‰å› ç½‘ç»œåˆ†åŒºæˆ–æ•…éšœè€Œæœªèƒ½ç»´æŒå¿ƒè·³çš„æœåŠ¡å®ä¾‹ä¼šå†æ¬¡å‘é€å¿ƒè·³åˆ° Eureka Serverã€‚æ­¤æ—¶ï¼ŒEureka Server ä¼šæ›´æ–°è¿™äº›æœåŠ¡å®ä¾‹çš„çŠ¶æ€ï¼Œå¹¶å°†æ–°çš„æˆ–æ”¹å˜çš„ä¿¡æ¯åŒæ­¥åˆ°æ•´ä¸ªé›†ç¾¤ä¸­ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†æœåŠ¡æ³¨å†Œä¿¡æ¯èƒ½å¤Ÿåœ¨ç½‘ç»œæ¢å¤åè¿…é€Ÿæ›´æ–°ï¼Œå¹¶åæ˜ æœ€æ–°çš„ç³»ç»ŸçŠ¶æ€ã€‚

### ç»“è®º

é€šè¿‡è¿™æ ·çš„è®¾è®¡ï¼ŒEureka åœ¨é‡åˆ°ç½‘ç»œé—®é¢˜å’ŒæœåŠ¡æ•…éšœæ—¶æä¾›äº†æ›´åŠ é²æ£’çš„æœåŠ¡å‘ç°æœºåˆ¶ã€‚å®ƒä¼˜å…ˆä¿è¯æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§å’ŒæœåŠ¡çš„å¯ç”¨æ€§ï¼Œå“ªæ€•æ˜¯ä»¥ç‰ºç‰²ä¸€éƒ¨åˆ†çš„æ•°æ®ä¸€è‡´æ€§ä¸ºä»£ä»·ã€‚è¿™ç§æƒè¡¡æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­å¸¸è§çš„å®è·µï¼Œå°¤å…¶æ˜¯åœ¨é‚£äº›å¯¹æœåŠ¡å¯ç”¨æ€§è¦æ±‚æé«˜çš„åœºæ™¯ä¸­ã€‚
```



https://www.cnblogs.com/zzyang/p/17943039

åŠ¨æ€é…ç½®æœåŠ¡ï¼š**Nacosæä¾›äº†åŠ¨æ€é…ç½®æœåŠ¡ï¼Œæ”¯æŒé…ç½®çš„ç‰ˆæœ¬å†å²å’Œå›æ»šï¼Œä»¥åŠç°åº¦å‘å¸ƒç­‰ åŠŸèƒ½ï¼Œè¿™æ˜¯Eurekaã€Zookeeperã€Consulç­‰ç¼ºä¹çš„ã€‚**
æ”¯æŒDNS-based Service Discoveryï¼šNacosæä¾›äº†DNS-based Service DiscoveryåŠŸèƒ½ï¼Œæ”¯æŒKubernetes DNSã€CoreDNSç­‰ï¼Œè¿™æ˜¯Eurekaã€Zookeeperã€Consulç­‰ç¼ºä¹çš„ã€‚
æ•°æ®æŒä¹…åŒ–ï¼š**Nacosæ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œå¯ä»¥å°†æœåŠ¡æ³¨å†Œä¿¡æ¯å’Œé…ç½®ä¿¡æ¯æŒä¹…åŒ–é“æ•°æ®åº“ä¸­**ï¼Œè€ŒEurekaé»˜è®¤ä¸æ”¯æŒæŒä¹…åŒ–ã€‚



ä¸´æ—¶å®ä¾‹å’Œæ°¸ä¹…å®ä¾‹åœ¨Nacosä¸­æ˜¯ä¸€ä¸ª**éå¸¸éå¸¸é‡è¦**çš„æ¦‚å¿µ

ä¹‹æ‰€ä»¥è¯´å®ƒé‡è¦ï¼Œä¸»è¦æ˜¯å› ä¸ºæˆ‘åœ¨è¯»æºç çš„æ—¶å€™å‘ç°ï¼Œä¸´æ—¶å®ä¾‹å’Œæ°¸ä¹…å®ä¾‹åœ¨åº•å±‚çš„è®¸å¤šå®ç°æœºåˆ¶æ˜¯å®Œå…¨ä¸åŒçš„

**ä¸´æ—¶å®ä¾‹**

ä¸´æ—¶å®ä¾‹åœ¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¹‹åä»…ä»…åªä¿å­˜åœ¨æœåŠ¡ç«¯å†…éƒ¨ä¸€ä¸ªç¼“å­˜ä¸­ï¼Œä¸ä¼šæŒä¹…åŒ–åˆ°ç£ç›˜

è¿™ä¸ªæœåŠ¡ç«¯å†…éƒ¨çš„ç¼“å­˜åœ¨æ³¨å†Œä¸­å¿ƒå±Šä¸€èˆ¬è¢«ç§°ä¸º**æœåŠ¡æ³¨å†Œè¡¨**

å½“æœåŠ¡å®ä¾‹å‡ºç°å¼‚å¸¸æˆ–è€…ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šæŠŠè¿™ä¸ªæœåŠ¡å®ä¾‹ä»æœåŠ¡æ³¨å†Œè¡¨ä¸­å‰”é™¤

**æ°¸ä¹…å®ä¾‹**

æ°¸ä¹…æœåŠ¡å®ä¾‹ä¸ä»…ä»…ä¼šå­˜åœ¨æœåŠ¡æ³¨å†Œè¡¨ä¸­ï¼ŒåŒæ—¶ä¹Ÿä¼šè¢«æŒä¹…åŒ–åˆ°ç£ç›˜æ–‡ä»¶ä¸­

å½“æœåŠ¡å®ä¾‹å‡ºç°å¼‚å¸¸æˆ–è€…ä¸‹çº¿ï¼ŒNacosåªä¼šå°†æœåŠ¡å®ä¾‹çš„å¥åº·çŠ¶æ€è®¾ç½®ä¸ºä¸å¥åº·ï¼Œå¹¶ä¸ä¼šå¯¹å°†å…¶ä»æœåŠ¡æ³¨å†Œè¡¨ä¸­å‰”é™¤

æ‰€ä»¥è¿™ä¸ªæœåŠ¡å®ä¾‹çš„ä¿¡æ¯ä½ è¿˜æ˜¯å¯ä»¥ä»æ³¨å†Œä¸­å¿ƒçœ‹åˆ°ï¼Œåªä¸è¿‡å¤„äºä¸å¥åº·çŠ¶æ€

è¿™æ˜¯å°±æ˜¯ä¸¤è€…æœ€æœ€æœ€åŸºæœ¬çš„åŒºåˆ«

> å½“ç„¶é™¤äº†ä¸Šè¿°æœ€åŸºæœ¬çš„åŒºåˆ«ä¹‹å¤–ï¼Œä¸¤è€…è¿˜æœ‰å¾ˆå¤šå…¶å®ƒçš„åŒºåˆ«ï¼Œæ¥ä¸‹æ¥æœ¬æ–‡è¿˜ä¼šæåˆ°

è¿™é‡Œä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªç–‘é—®

> ä¸ºä»€ä¹ˆNacosè¦å°†æœåŠ¡å®ä¾‹åˆ†ä¸ºä¸´æ—¶å®ä¾‹å’Œæ°¸ä¹…å®ä¾‹?

ä¸»è¦è¿˜æ˜¯å› ä¸ºåº”ç”¨åœºæ™¯ä¸åŒ

**ä¸´æ—¶å®ä¾‹**å°±æ¯”è¾ƒé€‚åˆäºä¸šåŠ¡æœåŠ¡ï¼ŒæœåŠ¡ä¸‹çº¿ä¹‹åå¯ä»¥ä¸éœ€è¦åœ¨æ³¨å†Œä¸­å¿ƒä¸­æŸ¥çœ‹åˆ°

**æ°¸ä¹…å®ä¾‹**å°±æ¯”è¾ƒé€‚åˆéœ€è¦è¿ç»´çš„æœåŠ¡ï¼Œè¿™ç§æœåŠ¡å‡ ä¹æ˜¯æ°¸ä¹…å­˜åœ¨çš„ï¼Œæ¯”å¦‚è¯´MySQLã€Redisç­‰ç­‰

> MySQLã€Redisç­‰æœåŠ¡å®ä¾‹å¯ä»¥é€šè¿‡SDKæ‰‹åŠ¨æ³¨å†Œ

å¯¹äºè¿™äº›æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç›´çœ‹åˆ°æœåŠ¡å®ä¾‹çš„çŠ¶æ€ï¼Œå³ä½¿å‡ºç°å¼‚å¸¸ï¼Œä¹Ÿéœ€è¦èƒ½å¤ŸæŸ¥çœ‹æ—¶å®çš„çŠ¶æ€

> æ‰€ä»¥ä»è¿™å¯ä»¥çœ‹å‡ºNacosè·Ÿä½ å°è±¡ä¸­çš„æ³¨å†Œä¸­å¿ƒä¸å¤ªä¸€æ ·ï¼Œä»–ä¸ä»…ä»…å¯ä»¥æ³¨å†Œå¹³æ—¶ä¸šåŠ¡ä¸­çš„å®ä¾‹ï¼Œè¿˜å¯ä»¥æ³¨å†ŒåƒMySQLã€Redisè¿™ä¸ªæœåŠ¡å®ä¾‹çš„ä¿¡æ¯åˆ°æ³¨å†Œä¸­å¿ƒ

åœ¨SpringCloudç¯å¢ƒåº•ä¸‹ï¼Œä¸€èˆ¬å…¶å®éƒ½æ˜¯ä¸šåŠ¡æœåŠ¡ï¼Œæ‰€ä»¥é»˜è®¤æ³¨å†ŒæœåŠ¡å®ä¾‹éƒ½æ˜¯ä¸´æ—¶å®ä¾‹

è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚

åœ¨1.xç‰ˆæœ¬ä¸­ï¼Œä¸€ä¸ªæœåŠ¡ä¸­å¯ä»¥æ—¢æœ‰ä¸´æ—¶å®ä¾‹ä¹Ÿæœ‰æ°¸ä¹…å®ä¾‹ï¼ŒæœåŠ¡å®ä¾‹æ˜¯æ°¸ä¹…è¿˜æ˜¯ä¸´æ—¶æ˜¯ç”±æœåŠ¡å®ä¾‹æœ¬èº«å†³å®šçš„

ä½†æ˜¯2.xç‰ˆæœ¬ä¸­ï¼Œä¸€ä¸ªæœåŠ¡ä¸­çš„æ‰€æœ‰å®ä¾‹è¦ä¹ˆéƒ½æ˜¯ä¸´æ—¶çš„è¦ä¹ˆéƒ½æ˜¯æ°¸ä¹…çš„ï¼Œæ˜¯ç”±æœåŠ¡å†³å®šçš„ï¼Œè€Œä¸æ˜¯å…·ä½“çš„æœåŠ¡å®ä¾‹

æ‰€ä»¥åœ¨2.xå¯ä»¥è¯´æ˜¯**ä¸´æ—¶æœåŠ¡**å’Œ**æ°¸ä¹…æœåŠ¡**

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528837-905586867.png)

> ä¸ºä»€ä¹ˆ2.xæŠŠä¸´æ—¶è¿˜æ˜¯æ°¸ä¹…çš„å±æ€§ç”±å®ä¾‹æœ¬èº«å†³å®šæ”¹æˆäº†ç”±æœåŠ¡å†³å®š?

å…¶å®å¾ˆç®€å•ï¼Œä½ æƒ³æƒ³ï¼Œå‡è®¾å¯¹ä¸€ä¸ªMySQLæœåŠ¡æ¥è¯´ï¼Œå®ƒçš„æ¯ä¸ªæœåŠ¡å®ä¾‹è‚¯å®šéƒ½æ˜¯æ°¸ä¹…çš„ï¼Œä¸ä¼šå‡ºç°ä¸€äº›æ˜¯æ°¸ä¹…çš„ï¼Œä¸€äº›æ˜¯ä¸´æ—¶çš„æƒ…å†µå§

æ‰€ä»¥ä¸´æ—¶è¿˜æ˜¯æ°¸ä¹…çš„å±æ€§ç”±æœåŠ¡æœ¬èº«å†³å®šå…¶å®å°±æ›´åŠ åˆç†äº†



### 2ã€CAPå®šç†å’ŒBASEç†è®º

è°ˆåˆ°æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œä¸€å®šç¦»ä¸å¼€ä¸¤ä¸ªè‘—ååˆ†å¸ƒå¼ç†è®º

- CAPå®šç†
- BASEç†è®º

CAPå®šç†ä¸­ï¼Œä¸‰ä¸ªå­—æ¯åˆ†åˆ«ä»£è¡¨è¿™äº›å«ä¹‰ï¼š

- Cï¼ŒConsistencyå•è¯çš„ç¼©å†™ï¼Œä»£è¡¨ä¸€è‡´æ€§ï¼ŒæŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å„ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¿æŒå¼ºä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ—¶åˆ»éƒ½å¿…é¡»ä¸€æ ·ï¼Œä¸ä¸€æ ·æ•´ä¸ªç³»ç»Ÿå°±ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡
- Aï¼ŒAvailabilityå•è¯çš„ç¼©å†™ï¼Œä»£è¡¨å¯ç”¨æ€§ï¼ŒæŒ‡æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¿æŒå¯¹å¤–å¯ç”¨ï¼Œå³ä½¿ä»æ¯ä¸ªèŠ‚ç‚¹è·å–çš„æ•°æ®å¯èƒ½éƒ½ä¸ä¸€æ ·ï¼Œåªè¦èƒ½è·å–åˆ°å°±è¡Œ
- Pï¼ŒPartition toleranceå•è¯çš„ç¼©å†™ï¼Œä»£è¡¨åˆ†åŒºå®¹é”™æ€§ã€‚

æ‰€è°“çš„CAPå®šç†ï¼Œå°±æ˜¯æŒ‡åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒCAPè¿™ä¸‰ä¸ªæŒ‡æ ‡ï¼Œæœ€å¤šåŒæ—¶åªèƒ½æ»¡è¶³å…¶ä¸­çš„ä¸¤ä¸ªï¼Œä¸å¯èƒ½ä¸‰ä¸ªéƒ½åŒæ—¶æ»¡è¶³

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528273-225636223.png)

ä¸ºä»€ä¹ˆä¸‰è€…ä¸èƒ½åŒæ—¶æ»¡è¶³ï¼Ÿ

å¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç½‘ç»œåˆ†åŒºæ˜¯ä¸€å®šéœ€è¦æ»¡è¶³çš„

è€Œæ‰€è°“åˆ†åŒºæŒ‡çš„æ˜¯ç³»ç»Ÿä¸­çš„æœåŠ¡éƒ¨ç½²åœ¨ä¸åŒçš„ç½‘ç»œåŒºåŸŸä¸­

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528352-1526114972.png)

æ¯”å¦‚ï¼ŒåŒä¸€å¥—ç³»ç»Ÿå¯èƒ½åŒæ—¶åœ¨åŒ—äº¬å’Œä¸Šæµ·éƒ½æœ‰éƒ¨ç½²ï¼Œé‚£ä¹ˆä»–ä»¬å°±å¤„äºä¸åŒçš„ç½‘ç»œåˆ†åŒºï¼Œå°±å¯èƒ½å‡ºç°æ— æ³•äº’ç›¸è®¿é—®çš„æƒ…å†µ

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠæ‰€æœ‰çš„æœåŠ¡éƒ½æ”¾åœ¨ä¸€ä¸ªç½‘ç»œåˆ†åŒºï¼Œä½†æ˜¯å½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½æ— æ³•å¯¹å¤–æä¾›æœåŠ¡ï¼Œé‚£è¿™è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ

æ‰€ä»¥åˆ†å¸ƒå¼ç³»ç»Ÿä¸€å®šéœ€è¦æ»¡è¶³åˆ†åŒºå®¹é”™æ€§ï¼ŒæŠŠç³»ç»Ÿéƒ¨ç½²åœ¨ä¸åŒçš„åŒºåŸŸç½‘ç»œä¸­

æ­¤æ—¶åªå‰©ä¸‹äº†ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ï¼Œå®ƒä»¬ä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶æ»¡è¶³ï¼Ÿ

å…¶å®ç­”æ¡ˆå¾ˆç®€å•ï¼Œå°±å› ä¸ºå¯èƒ½å‡ºç°ç½‘ç»œåˆ†åŒºå¯¼è‡´çš„é€šä¿¡å¤±è´¥ã€‚

æ¯”å¦‚è¯´ï¼Œç°åœ¨å‡ºç°äº†ç½‘ç»œåˆ†åŒºçš„é—®é¢˜ï¼Œä¸Šå›¾ä¸­çš„Aç½‘ç»œåŒºåŸŸå’ŒBç½‘ç»œåŒºåŸŸæ— æ³•ç›¸äº’è®¿é—®

æ­¤æ—¶å‡è®¾å¾€ä¸Šå›¾ä¸­çš„Aç½‘ç»œåŒºåŸŸå‘é€è¯·æ±‚ï¼Œå°†æœåŠ¡ä¸­çš„ä¸€ä¸ªå€¼ i å±æ€§è®¾ç½®æˆ 1

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528544-588182152.png)

**å¦‚æœä¿è¯å¯ç”¨æ€§**ï¼Œæ­¤æ—¶ç”±äºAå’ŒBç½‘ç»œä¸é€šï¼Œæ­¤æ—¶åªæœ‰Aä¸­çš„æœåŠ¡ä¿®æ”¹æˆåŠŸï¼ŒBæ— æ³•ä¿®æ”¹æˆåŠŸï¼Œæ­¤æ—¶æ•°æ®ABåŒºåŸŸæ•°æ®å°±ä¸ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ²¡æœ‰ä¿è¯æ•°æ®ä¸€è‡´æ€§

**å¦‚æœä¿è¯ä¸€è‡´æ€§**ï¼Œæ­¤æ—¶ç”±äºAå’ŒBç½‘ç»œä¸é€šï¼Œæ‰€ä»¥æ­¤æ—¶Aä¹Ÿä¸èƒ½ä¿®æ”¹æˆåŠŸï¼Œå¿…é¡»ä¿®æ”¹å¤±è´¥ï¼Œå¦åˆ™å°±ä¼šå¯¼è‡´ABæ•°æ®ä¸ä¸€è‡´

è™½ç„¶Aæ²¡ä¿®æ”¹æˆåŠŸï¼Œä¿è¯äº†æ•°æ®ä¸€è‡´æ€§ï¼ŒABè¿˜æ˜¯ä¹‹å‰ç›¸åŒçš„æ•°æ®ï¼Œä½†æ˜¯æ­¤æ—¶æ•´ä¸ªç³»ç»Ÿå·²ç»æ²¡æœ‰å†™å¯ç”¨æ€§äº†ï¼Œæ— æ³•æˆåŠŸå†™æ•°æ®äº†ã€‚

**æ‰€ä»¥ä»ä¸Šé¢åˆ†æå¯ä»¥çœ‹å‡ºï¼Œåœ¨æœ‰åˆ†åŒºå®¹é”™æ€§çš„å‰æä¸‹ï¼Œå¯ç”¨æ€§å’Œä¸€è‡´æ€§æ˜¯æ— æ³•åŒæ—¶ä¿è¯çš„ã€‚**

è™½ç„¶æ— æ³•åŒæ—¶ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ï¼Œä½†æ˜¯èƒ½ä¸èƒ½æ¢ç§æ€è·¯æ¥æ€è€ƒä¸€ä¸‹è¿™ä¸ªé—®é¢˜

é¦–å…ˆæˆ‘ä»¬å¯ä»¥å…ˆä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œä¹Ÿå°±æ˜¯å…ˆè®©ç³»ç»Ÿèƒ½å¤Ÿå†™æ•°æ®ï¼Œå°†AåŒºåŸŸæœåŠ¡ä¸­çš„iä¿®æ”¹æˆ1

ä¹‹åå½“ABåŒºåŸŸä¹‹é—´ç½‘ç»œæ¢å¤ä¹‹åï¼Œå°†AåŒºåŸŸçš„iå€¼å¤åˆ¶ç»™BåŒºåŸŸï¼Œè¿™æ ·å°±èƒ½å¤Ÿä¿è¯ABåŒºåŸŸé—´çš„æ•°æ®æœ€ç»ˆæ˜¯ä¸€è‡´çš„äº†

è¿™ä¸å°±çš†å¤§æ¬¢å–œäº†ä¹ˆ

è¿™ç§æ€è·¯å…¶å®å°±æ˜¯BASEç†è®ºçš„æ ¸å¿ƒè¦ç‚¹ï¼Œä¼˜å…ˆä¿è¯å¯ç”¨æ€§ï¼Œæ•°æ®æœ€ç»ˆè¾¾æˆä¸€è‡´æ€§ã€‚

BASEç†è®ºä¸»è¦æ˜¯åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç‚¹ï¼š

- åŸºæœ¬å¯ç”¨ï¼ˆBasically Availableï¼‰ï¼šç³»ç»Ÿå‡ºç°æ•…éšœè¿˜æ˜¯èƒ½å¤Ÿå¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸è‡³äºç›´æ¥æ— æ³•ç”¨äº†
- è½¯çŠ¶æ€ï¼ˆSoft Stateï¼‰ï¼šå…è®¸å„ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¸ä¸€è‡´
- æœ€ç»ˆä¸€è‡´æ€§ï¼Œï¼ˆEventually Consistentï¼‰ï¼šè™½ç„¶å…è®¸å„ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†æ˜¯åœ¨ä¸€å®šæ—¶é—´ä¹‹åï¼Œå„ä¸ªèŠ‚ç‚¹çš„æ•°æ®æœ€ç»ˆéœ€è¦ä¸€è‡´çš„

BASEç†è®ºå…¶å®å°±æ˜¯å¦¥åä¹‹åçš„äº§ç‰©ã€‚

### 3ã€Nacosçš„APå’ŒCP

Nacoså…¶å®ç›®å‰æ˜¯åŒæ—¶æ”¯æŒAPå’ŒCPçš„

å…·ä½“ä½¿ç”¨APè¿˜æ˜¯CPå¾—å–å†³äºNacoså†…éƒ¨çš„å…·ä½“åŠŸèƒ½ï¼Œå¹¶ä¸æ˜¯æœ‰çš„æ–‡ç« è¯´çš„å¯ä»¥é€šè¿‡ä¸€ä¸ªé…ç½®è‡ªç”±åˆ‡æ¢ã€‚

å°±ä»¥æœåŠ¡æ³¨å†Œä¸¾ä¾‹æ¥è¯´ï¼Œ**å¯¹äºä¸´æ—¶å®ä¾‹æ¥è¯´ï¼ŒNacosä¼šä¼˜å…ˆä¿è¯å¯ç”¨æ€§ï¼Œä¹Ÿå°±æ˜¯AP**

å¯¹äº**æ°¸ä¹…å®ä¾‹ï¼ŒNacosä¼šä¼˜å…ˆä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯CP**

æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥è®²ä¸€è®²Nacosçš„CPå’ŒAPçš„å®ç°åŸç†

#### 3.1ã€Nacosçš„APå®ç°

å¯¹äºAPæ¥è¯´ï¼ŒNacosä½¿ç”¨çš„æ˜¯é˜¿é‡Œè‡ªç ”çš„**Distroåè®®**

åœ¨è¿™ä¸ªåè®®ä¸­ï¼Œ**æ¯ä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¹³ç­‰çš„çŠ¶æ€ï¼Œæ¯ä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹æ­£å¸¸æƒ…å†µä¸‹æ•°æ®æ˜¯ä¸€æ ·çš„ï¼Œæ¯ä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹éƒ½å¯ä»¥æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚**

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528584-2019455475.png)

å½“æŸä¸ªèŠ‚ç‚¹åˆšå¯åŠ¨æ—¶ï¼Œ**ä»–ä¼šå‘é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹å‘é€è¯·æ±‚ï¼Œæ‹‰å–æ‰€æœ‰çš„æœåŠ¡å®ä¾‹æ•°æ®åˆ°è‡ªå·±çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­**

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528600-2085582310.png)

è¿™æ ·å…¶å®ƒå®¢æˆ·ç«¯å°±å¯ä»¥ä»è¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ä¸­è·å–åˆ°æœåŠ¡å®ä¾‹æ•°æ®äº†

å½“æŸä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹æ¥æ”¶åˆ°æ³¨å†Œ**ä¸´æ—¶æœåŠ¡å®ä¾‹**çš„è¯·æ±‚ï¼Œä¸ä»…ä»…ä¼šå°†è¿™ä¸ªæœåŠ¡å®ä¾‹å­˜åˆ°è‡ªèº«çš„æœåŠ¡æ³¨å†Œè¡¨ï¼ŒåŒæ—¶ä¹Ÿä¼šå‘å…¶å®ƒæ‰€æœ‰æœåŠ¡èŠ‚ç‚¹å‘é€è¯·æ±‚ï¼Œå°†è¿™ä¸ªæœåŠ¡æ•°æ®åŒæ­¥åˆ°å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528587-300147597.png)

æ‰€ä»¥æ­¤æ—¶ä»ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„æœåŠ¡å®ä¾‹æ•°æ®çš„ã€‚

å³ä½¿æ•°æ®åŒæ­¥çš„è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸ï¼ŒæœåŠ¡å®ä¾‹ä¹ŸæˆåŠŸæ³¨å†Œåˆ°ä¸€ä¸ªNacosæœåŠ¡ä¸­ï¼Œå¯¹å¤–éƒ¨è€Œè¨€ï¼Œæ•´ä¸ªNacosé›†ç¾¤æ˜¯å¯ç”¨çš„ï¼Œä¹Ÿå°±è¾¾åˆ°äº†APçš„æ•ˆæœ

åŒæ—¶ä¸ºäº†æ»¡è¶³BASEç†è®ºï¼ŒNacosä¹Ÿæœ‰ä¸‹é¢ä¸¤ç§æœºåˆ¶ä¿è¯æœ€ç»ˆèŠ‚ç‚¹é—´æ•°æ®æœ€ç»ˆæ˜¯ä¸€è‡´çš„ï¼š

- å¤±è´¥é‡è¯•æœºåˆ¶
- å®šæ—¶å¯¹æ¯”æœºåˆ¶

**å¤±è´¥é‡è¯•æœºåˆ¶**æ˜¯æŒ‡å½“æ•°æ®åŒæ­¥ã€**ç»™å…¶å®ƒèŠ‚ç‚¹å¤±è´¥æ—¶ï¼Œä¼šæ¯éš”3sé‡è¯•ä¸€æ¬¡ï¼Œç›´åˆ°æˆåŠŸ**ã€‘

**å®šæ—¶å¯¹æ¯”æœºåˆ¶**å°±æ˜¯æŒ‡ï¼Œæ¯ä¸ªNacosæœåŠ¡èŠ‚ç‚¹ä¼šå®šæ—¶å‘æ‰€æœ‰çš„å…¶å®ƒæœåŠ¡èŠ‚ç‚¹å‘é€ä¸€äº›è®¤è¯çš„è¯·æ±‚ã€æ”¶åˆ°æ—§çš„ï¼Œå°†æ–°çš„å‘é€ç»™è¯¥èŠ‚ç‚¹ï¼Œæ”¶åˆ°æ–°çš„å°±ä¸ç”¨ç®¡ã€‘

è¿™ä¸ªè¯·æ±‚ä¼šå‘Šè¯‰æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹**è‡ªå·±è´Ÿè´£çš„æœåŠ¡å®ä¾‹**çš„å¯¹åº”çš„ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªç‰ˆæœ¬å·éšç€æœåŠ¡å®ä¾‹çš„å˜åŠ¨å°±ä¼šå˜åŠ¨

å¦‚æœå…¶å®ƒæœåŠ¡èŠ‚ç‚¹çš„æ•°æ®çš„ç‰ˆæœ¬å·è·Ÿè‡ªå·±çš„å¯¹ä¸ä¸Šï¼Œé‚£å°±è¯´æ˜å…¶å®ƒæœåŠ¡èŠ‚ç‚¹çš„æ•°æ®ä¸æ˜¯æœ€æ–°çš„

æ­¤æ—¶è¿™ä¸ª**NacosæœåŠ¡èŠ‚ç‚¹å°±ä¼šå°†è‡ªå·±è´Ÿè´£çš„æœåŠ¡å®ä¾‹æ•°æ®å‘ç»™ä¸æ˜¯æœ€æ–°æ•°æ®çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å°±ä¿è¯äº†æ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®æ˜¯ä¸€æ ·çš„äº†**ã€‚

```
æ‚¨æåˆ°çš„ **å¤±è´¥é‡è¯•æœºåˆ¶** å’Œ **å®šæ—¶å¯¹æ¯”æœºåˆ¶** æ˜¯ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¿è¯å¤šä¸ªæœåŠ¡èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§å’Œå¯é æ€§çš„ç­–ç•¥ã€‚è¿™äº›æœºåˆ¶åœ¨åˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ Nacosï¼‰ä¸­å°¤ä¸ºå¸¸è§ã€‚è®©æˆ‘è¯¦ç»†è§£é‡Šè¿™ä¸¤ç§æœºåˆ¶çš„åŸç†å’Œå®ƒä»¬çš„ä½œç”¨ï¼š

### 1. **å¤±è´¥é‡è¯•æœºåˆ¶**

**å®šä¹‰**ï¼š  
å¤±è´¥é‡è¯•æœºåˆ¶æŒ‡çš„æ˜¯å½“æŸä¸ªæœåŠ¡èŠ‚ç‚¹åœ¨æ‰§è¡ŒæŸé¡¹æ“ä½œå¤±è´¥åï¼Œä¼šè¿›è¡Œä¸€ç³»åˆ—çš„è‡ªåŠ¨é‡è¯•ï¼Œç›´åˆ°æ“ä½œæˆåŠŸä¸ºæ­¢ã€‚

**åœºæ™¯**ï¼š
- æ•°æ®åŒæ­¥ï¼šåœ¨ Nacos æˆ–ç±»ä¼¼çš„åˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸­å¿ƒä¸­ï¼ŒæœåŠ¡èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®éœ€è¦ä¿æŒä¸€è‡´æ€§ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹æ›´æ–°æ•°æ®æ—¶ï¼Œéœ€è¦å°†è¿™äº›å˜æ›´åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ã€‚å¦‚æœæ•°æ®åŒæ­¥è¿‡ç¨‹ä¸­å‡ºç°ç½‘ç»œæ³¢åŠ¨æˆ–ç³»ç»Ÿæ•…éšœå¯¼è‡´åŒæ­¥å¤±è´¥ï¼Œå°±éœ€è¦è¿›è¡Œé‡è¯•æ“ä½œï¼Œç¡®ä¿æ•°æ®æœ€ç»ˆèƒ½å¤ŸæˆåŠŸåŒæ­¥ã€‚

**å®ç°æ–¹å¼**ï¼š
- **å®šæ—¶é‡è¯•**ï¼šåœ¨æ•°æ®åŒæ­¥å¤±è´¥åï¼ŒæœåŠ¡èŠ‚ç‚¹ä¼šå¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”3ç§’é’Ÿå†é‡æ–°å°è¯•è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚è¿™ç§å®šæ—¶é‡è¯•çš„æ–¹å¼ï¼Œèƒ½å¤Ÿé¿å…åœ¨çŸ­æš‚çš„ç½‘ç»œæ•…éšœä¸‹ç«‹å³æ”¾å¼ƒåŒæ­¥æ“ä½œï¼Œä¿è¯æœ€ç»ˆçš„æ•°æ®ä¸€è‡´æ€§ã€‚
- **æ— æŸæ•°æ®åŒæ­¥**ï¼šé‡è¯•æœºåˆ¶éœ€è¦ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ¯æ¬¡é‡è¯•æ—¶ä¼šé‡æ–°æ£€æŸ¥è¦åŒæ­¥çš„æ•°æ®æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œç¡®ä¿ä¸ä¸¢å¤±é‡è¦çš„æ›´æ–°ã€‚

**ä¼˜ç‚¹**ï¼š
- å¯é æ€§ï¼šé€šè¿‡ä¸æ–­é‡è¯•ï¼Œèƒ½å¤Ÿç¡®ä¿åœ¨ç½‘ç»œæ•…éšœã€èŠ‚ç‚¹å®•æœºç­‰ä¸´æ—¶é—®é¢˜æ¢å¤åï¼Œæœ€ç»ˆèƒ½å¤ŸæˆåŠŸå°†æ•°æ®åŒæ­¥åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚
- å®¹é”™æ€§ï¼šå…è®¸ç³»ç»Ÿåœ¨å‘ç”ŸçŸ­æš‚æ•…éšœæ—¶ä¸ç«‹å³æ”¾å¼ƒæ“ä½œï¼Œè€Œæ˜¯é€šè¿‡å¤šæ¬¡é‡è¯•æœ€ç»ˆå®Œæˆä»»åŠ¡ã€‚

### 2. **å®šæ—¶å¯¹æ¯”æœºåˆ¶**

**å®šä¹‰**ï¼š  
å®šæ—¶å¯¹æ¯”æœºåˆ¶æŒ‡çš„æ˜¯æœåŠ¡èŠ‚ç‚¹ä¼šå®šæ—¶å‘å…¶å®ƒèŠ‚ç‚¹å‘é€è‡ªèº«çš„çŠ¶æ€å’Œæ•°æ®ç‰ˆæœ¬å·ï¼Œå¹¶ä¸å…¶å®ƒèŠ‚ç‚¹çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœå‘ç°æ•°æ®ä¸ä¸€è‡´ï¼Œä¾¿ä¼šè¿›è¡Œæ•°æ®åŒæ­¥ï¼Œç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®æœ€ç»ˆä¸€è‡´ã€‚

**åœºæ™¯**ï¼š
- åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ Nacosï¼‰ä¸­ï¼Œæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹å¯èƒ½éƒ½æ‹¥æœ‰ä¸€éƒ¨åˆ†æœåŠ¡å®ä¾‹çš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯ä¼šä¸æ–­å‘ç”Ÿå˜åŒ–ï¼Œä¾‹å¦‚å½“æœåŠ¡å®ä¾‹ä¸Šçº¿æˆ–ä¸‹çº¿æ—¶ï¼Œå…¶ç‰ˆæœ¬å·ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚ä¸ºäº†ä¿è¯æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹çš„æ•°æ®éƒ½æ˜¯æœ€æ–°çš„ï¼Œç³»ç»Ÿéœ€è¦å®šæœŸæ£€æŸ¥å…¶å®ƒèŠ‚ç‚¹çš„æ•°æ®ã€‚

**å®ç°æ–¹å¼**ï¼š
- **ç‰ˆæœ¬å·æ¯”å¯¹**ï¼šæ¯ä¸ª Nacos æœåŠ¡èŠ‚ç‚¹ä¼šå®šæ—¶å‘é€è®¤è¯è¯·æ±‚ç»™å…¶å®ƒèŠ‚ç‚¹ï¼Œå¹¶é™„å¸¦è‡ªå·±æ‰€ç»´æŠ¤çš„æœåŠ¡å®ä¾‹çš„ç‰ˆæœ¬å·ã€‚å…¶å®ƒèŠ‚ç‚¹ä¼šæ”¶åˆ°è¿™ä¸ªè¯·æ±‚å¹¶è¿›è¡Œç‰ˆæœ¬å·å¯¹æ¯”ã€‚
  - å¦‚æœæŸä¸ªèŠ‚ç‚¹å‘ç°è‡ªå·±ç»´æŠ¤çš„ç‰ˆæœ¬å·ä¸å‘é€è¯·æ±‚çš„èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œå°±æ„å‘³ç€æ•°æ®ä¸ä¸€è‡´ã€‚
- **æ•°æ®åŒæ­¥**ï¼šä¸€æ—¦å‘ç°æ•°æ®ä¸ä¸€è‡´ï¼Œæ‹¥æœ‰æœ€æ–°ç‰ˆæœ¬æ•°æ®çš„èŠ‚ç‚¹å°±ä¼šä¸»åŠ¨å°†è‡ªå·±çš„æœåŠ¡å®ä¾‹æ•°æ®åŒæ­¥ç»™é‚£äº›æ•°æ®è½åçš„èŠ‚ç‚¹ã€‚è¿™ç§æ–¹å¼é€šè¿‡ä¸»åŠ¨åŒæ­¥çš„æ–¹å¼ï¼Œä¿è¯æ¯ä¸ªèŠ‚ç‚¹æœ€ç»ˆæ‹¥æœ‰ç›¸åŒçš„æœ€æ–°æ•°æ®ã€‚

**ä¼˜ç‚¹**ï¼š
- **æ•°æ®ä¸€è‡´æ€§**ï¼šå®šæ—¶å¯¹æ¯”æœºåˆ¶èƒ½å¤Ÿç¡®ä¿åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šæ•°æ®ä¿æŒä¸€è‡´ï¼Œä¸ä¼šå› ä¸ºæŸä¸ªèŠ‚ç‚¹çš„æ•…éšœæˆ–ç½‘ç»œé—®é¢˜å¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹çš„æ•°æ®æ»åã€‚
- **ä½å»¶è¿ŸåŒæ­¥**ï¼šé€šè¿‡å®šæ—¶æ¯”å¯¹æœºåˆ¶ï¼Œç³»ç»Ÿå¯ä»¥å¿«é€Ÿå‘ç°å¹¶ä¿®å¤æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä¸éœ€è¦ä¾èµ–æ‰‹åŠ¨æ“ä½œã€‚

### ä¸¤ç§æœºåˆ¶çš„å…³ç³»ï¼š
1. **å¤±è´¥é‡è¯•æœºåˆ¶** ç¡®ä¿å½“æŸä¸ªæ“ä½œï¼ˆå¦‚æ•°æ®åŒæ­¥ï¼‰å¤±è´¥æ—¶ï¼Œç³»ç»Ÿå¯ä»¥è‡ªåŠ¨è¿›è¡Œå¤šæ¬¡é‡è¯•ï¼Œæœ€ç»ˆå®Œæˆæ“ä½œã€‚å®ƒä¸»è¦ç”¨äºé˜²æ­¢ç”±äºçŸ­æœŸçš„ç½‘ç»œæ•…éšœã€ç³»ç»Ÿæ•…éšœç­‰å¯¼è‡´çš„å•æ¬¡æ“ä½œå¤±è´¥ã€‚
   
2. **å®šæ—¶å¯¹æ¯”æœºåˆ¶** åˆ™ç”¨äºå®šæœŸæ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®çŠ¶æ€ï¼Œç¡®ä¿é•¿æœŸçš„ä¸€è‡´æ€§ï¼Œå³ä½¿æ²¡æœ‰ä¸»åŠ¨çš„æ•°æ®åŒæ­¥è¯·æ±‚ï¼Œå®ƒä¹Ÿä¼šé€šè¿‡å¯¹æ¯”ç‰ˆæœ¬å·æ¥å‘ç°å¹¶ä¿®å¤æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚

### ä¾‹å­ï¼š
- å‡è®¾æœ‰ä¸‰ä¸ª Nacos èŠ‚ç‚¹ Aã€B å’Œ Cã€‚èŠ‚ç‚¹ A æ›´æ–°äº†æœåŠ¡å®ä¾‹æ•°æ®ï¼Œå¹¶å°è¯•åŒæ­¥åˆ°èŠ‚ç‚¹ B å’Œ Cã€‚
  - **å¤±è´¥é‡è¯•æœºåˆ¶**ï¼šå¦‚æœèŠ‚ç‚¹ A åœ¨åŒæ­¥æ•°æ®ç»™ B æ—¶å¤±è´¥ï¼ŒA ä¼šæ¯éš” 3 ç§’é‡è¯•ï¼Œç›´åˆ°åŒæ­¥æˆåŠŸã€‚
  - **å®šæ—¶å¯¹æ¯”æœºåˆ¶**ï¼šå‡è®¾ç”±äºç½‘ç»œé—®é¢˜ï¼ŒA æ— æ³•åŒæ­¥åˆ° Cã€‚æ­¤æ—¶ï¼Œå®šæ—¶å¯¹æ¯”æœºåˆ¶å¯åŠ¨ï¼ŒC ä¼šå®šæœŸå‘ A å’Œ B å‘é€ç‰ˆæœ¬å·è®¤è¯è¯·æ±‚ã€‚ä¸€æ—¦ C å‘ç°å®ƒçš„æ•°æ®ç‰ˆæœ¬å·ä¸ A ä¸ä¸€è‡´ï¼ŒA ä¼šå°†æœ€æ–°çš„æ•°æ®åŒæ­¥ç»™ Cï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚

### æ€»ç»“ï¼š
- **å¤±è´¥é‡è¯•æœºåˆ¶** æä¾›äº†çŸ­æœŸçš„å®¹é”™èƒ½åŠ›ï¼Œç¡®ä¿åœ¨å¤±è´¥æƒ…å†µä¸‹é€šè¿‡å¤šæ¬¡é‡è¯•å®Œæˆæ“ä½œã€‚
- **å®šæ—¶å¯¹æ¯”æœºåˆ¶** åˆ™æä¾›äº†é•¿æœŸçš„æ•°æ®ä¸€è‡´æ€§ä¿éšœï¼Œé€šè¿‡ç‰ˆæœ¬å·å¯¹æ¯”åŠæ—¶å‘ç°æ•°æ®ä¸ä¸€è‡´ï¼Œå¹¶è¿›è¡Œæ•°æ®åŒæ­¥ã€‚

è¿™ä¸¤ç§æœºåˆ¶ç›¸äº’é…åˆï¼Œèƒ½å¤Ÿä¿è¯ Nacos æœåŠ¡èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§å’Œç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚
```



#### 3.2ã€Nacosçš„CPå®ç°

Nacosçš„CPå®ç°æ˜¯åŸºäºRaftç®—æ³•æ¥å®ç°çš„

åœ¨1.xç‰ˆæœ¬æ—©æœŸï¼ŒNacosæ˜¯è‡ªå·±æ‰‹åŠ¨å®ç°Raftç®—æ³•

åœ¨2.xç‰ˆæœ¬ï¼ŒNacosç§»é™¤äº†æ‰‹åŠ¨å®ç°Raftç®—æ³•ï¼Œè½¬è€Œæ‹¥æŠ±åŸºäºèš‚èšå¼€æºçš„JRaftæ¡†æ¶

åœ¨Raftç®—æ³•ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªçŠ¶æ€

- Leaderï¼Œè´Ÿè´£æ‰€æœ‰çš„è¯»å†™è¯·æ±‚ï¼Œä¸€ä¸ªé›†ç¾¤åªæœ‰ä¸€ä¸ª
- Followerï¼Œä»èŠ‚ç‚¹ï¼Œä¸»è¦æ˜¯è´Ÿè´£å¤åˆ¶Leaderçš„æ•°æ®ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§
- Candidateï¼Œå€™é€‰èŠ‚ç‚¹ï¼Œæœ€ç»ˆä¼šå˜æˆLeaderæˆ–è€…Follower

é›†ç¾¤å¯åŠ¨æ—¶éƒ½æ˜¯èŠ‚ç‚¹Followerï¼Œç»è¿‡ä¸€æ®µæ—¶é—´ä¼šè½¬æ¢æˆCandidateçŠ¶æ€ï¼Œå†ç»è¿‡ä¸€ç³»åˆ—å¤æ‚çš„é€‰æ‹©ç®—æ³•ï¼Œé€‰å‡ºä¸€ä¸ªLeader

![img](https://img2024.cnblogs.com/blog/2880613/202403/2880613-20240312164528632-1668395587.png)

> è¿™ä¸ªé€‰ä¸¾ç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œå®Œå…¨å€¼å¾—å¦å†™ä¸€ç¯‡æ–‡ç« ï¼Œè¿™é‡Œå°±ä¸ç»†è¯´äº†ã€‚ä¸è¿‡ç«‹ä¸ªflagï¼Œå¦‚æœæœ¬ç¯‡æ–‡ç« ç‚¹èµé‡è¶…è¿‡28ä¸ªï¼Œæˆ‘è¿å¤œçˆ†è‚ï¼Œå†æ¥ä¸€ç¯‡ã€‚

å½“æœ‰å†™è¯·æ±‚æ—¶ï¼Œå¦‚æœè¯·æ±‚çš„èŠ‚ç‚¹ä¸æ˜¯LeaderèŠ‚ç‚¹æ—¶ï¼Œä¼šå°†è¯·æ±‚è½¬ç»™LeaderèŠ‚ç‚¹ï¼Œç”±LeaderèŠ‚ç‚¹å¤„ç†å†™è¯·æ±‚

æ¯”å¦‚ï¼Œæœ‰ä¸ªå®¢æˆ·ç«¯è¿åˆ°çš„ä¸Šå›¾ä¸­çš„`NacosæœåŠ¡2`èŠ‚ç‚¹ï¼Œä¹‹åå‘`NacosæœåŠ¡2`æ³¨å†ŒæœåŠ¡

`NacosæœåŠ¡2`æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯LeaderèŠ‚ç‚¹ï¼Œå‘ç°è‡ªå·±ä¸æ˜¯

æ­¤æ—¶`NacosæœåŠ¡2`å°±ä¼šå‘LeaderèŠ‚ç‚¹å‘é€è¯·æ±‚ï¼ŒLeaderèŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šå¤„ç†æœåŠ¡æ³¨å†Œçš„è¿‡ç¨‹

ä¸ºä»€ä¹ˆè¯´Raftæ˜¯ä¿è¯CPçš„å‘¢ï¼Ÿ

ä¸»è¦æ˜¯å› ä¸ºRaftåœ¨å¤„ç†å†™çš„æ—¶å€™æœ‰ä¸€ä¸ªåˆ¤æ–­è¿‡ç¨‹

- é¦–å…ˆï¼ŒLeaderåœ¨å¤„ç†å†™è¯·æ±‚æ—¶ï¼Œä¸ä¼šç›´æ¥æ•°æ®åº”ç”¨åˆ°è‡ªå·±çš„ç³»ç»Ÿï¼Œè€Œæ˜¯å…ˆå‘æ‰€æœ‰çš„Followerå‘é€è¯·æ±‚ï¼Œè®©ä»–ä»¬å…ˆå¤„ç†è¿™ä¸ªè¯·æ±‚
- å½“è¶…è¿‡åŠæ•°çš„FolloweræˆåŠŸå¤„ç†äº†è¿™ä¸ªå†™è¯·æ±‚ä¹‹åï¼ŒLeaderæ‰ä¼šå†™æ•°æ®ï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯è¯·æ±‚å¤„ç†æˆåŠŸ
- å¦‚æœè¶…è¿‡ä¸€å®šæ—¶é—´æœªæ”¶åˆ°è¶…è¿‡åŠæ•°å¤„ç†æˆåŠŸFollowerçš„ä¿¡å·ï¼Œæ­¤æ—¶Leaderè®¤ä¸ºè¿™æ¬¡å†™æ•°æ®æ˜¯å¤±è´¥çš„ï¼Œå°±ä¸ä¼šå¤„ç†å†™è¯·æ±‚ï¼Œç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯è¯·æ±‚å¤±è´¥

æ‰€ä»¥ï¼Œä¸€æ—¦å‘ç”Ÿæ•…éšœï¼Œå¯¼è‡´æ¥æ”¶ä¸åˆ°åŠæ•°çš„Followerå†™æˆåŠŸçš„å“åº”ï¼Œæ•´ä¸ªé›†ç¾¤å°±ç›´æ¥å†™å¤±è´¥ï¼Œè¿™å°±å¾ˆç¬¦åˆCPçš„æ¦‚å¿µäº†ã€‚

ä¸è¿‡è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚éœ€è¦æ³¨æ„

Nacosåœ¨å¤„ç†æŸ¥è¯¢æœåŠ¡å®ä¾‹çš„è¯·æ±‚ç›´æ¥æ—¶ï¼Œå¹¶ä¸ä¼šå°†è¯·æ±‚è½¬å‘ç»™LeaderèŠ‚ç‚¹å¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥æŸ¥å½“å‰NacosæœåŠ¡å®ä¾‹çš„æ³¨å†Œè¡¨

è¿™å…¶å®å°±ä¼šå¼•å‘ä¸€ä¸ªé—®é¢˜

å¦‚æœå®¢æˆ·ç«¯æŸ¥è¯¢çš„**FollowerèŠ‚ç‚¹æ²¡æœ‰åŠæ—¶å¤„ç†LeaderåŒæ­¥è¿‡æ¥çš„å†™è¯·æ±‚ï¼ˆè¿‡åŠå“åº”çš„èŠ‚ç‚¹ä¸­ä¸åŒ…æ‹¬è¿™ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œæ­¤æ—¶åœ¨è¿™ä¸ªFollowerå…¶å®æ˜¯æŸ¥ä¸åˆ°æœ€æ–°çš„æ•°æ®çš„ï¼Œè¿™å°±ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´**

æ‰€ä»¥è¯´ï¼Œè™½ç„¶Raftåè®®è§„å®šè¦æ±‚ä»LeaderèŠ‚ç‚¹æŸ¥æœ€æ–°çš„æ•°æ®ï¼Œä½†æ˜¯Nacosè‡³å°‘åœ¨è¯»æœåŠ¡å®ä¾‹æ•°æ®æ—¶å¹¶æ²¡æœ‰éµå®ˆè¿™ä¸ªåè®®

å½“ç„¶å¯¹äºå…¶å®ƒçš„ä¸€äº›æ•°æ®çš„è¯»å†™è¯·æ±‚æœ‰çš„è¿˜æ˜¯éµå®ˆäº†è¿™ä¸ªåè®®ã€‚

> JRaftå¯¹äºè¯»è¯·æ±‚å…¶å®æ˜¯åšäº†å¾ˆå¤šä¼˜åŒ–çš„ï¼Œå…¶å®ä»FollowerèŠ‚ç‚¹é€šè¿‡ä¸€å®šçš„æœºåˆ¶ä¹Ÿæ˜¯èƒ½å¤Ÿä¿è¯è¯»åˆ°æœ€æ–°çš„æ•°æ®
